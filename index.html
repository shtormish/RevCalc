<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Fix for icons on GitHub Pages: Set Content Security Policy to allow images from shields.io -->
    <meta http-equiv="Content-Security-Policy" content="img-src 'self' data: https://img.shields.io;">
    <!-- Add a simple emoji-based favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ“ˆ</text></svg>">
    <title>Investment Calculator</title>
    <style>
        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --secondary: #f8fafc;
            --text: #0f172a;
            --text-secondary: #64748b;
            --border: #e2e8f0;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            color: var(--text);
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 6px;
            padding: 15px 20px;
            background: white;
            border-radius: 16px;
            box-shadow: var(--shadow);
        }

        .header__title {
            font-size: 1.75rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header__actions {
            display: flex;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
            justify-content: flex-end;
        }

        .header__badges {
            display: flex;
            gap: 10px;
        }

        .header__button {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s ease;
            box-shadow: var(--shadow);
        }

        .header__button:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
        }

        .calculator {
            display: grid;
            grid-template-columns: 1fr;
            gap: 6px;
            margin-bottom: 6px;
        }

        .input-section, .results-section {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: var(--shadow);
        }

        .section__title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 6px;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .input-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px 20px;
        }

        .input-group { /* This can remain as a block itself */
            margin-bottom: 0;
        }

        .input-group__label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            font-size: 0.95rem;
        }

        .input-group__hint {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: 4px;
            line-height: 1.4;
        }

        .input-group__field {
            width: 100%;
            padding: 10px 14px;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.2s ease;
            background: var(--secondary);
        }

        .input-group__field:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .input-group__row {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 15px;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
        }

        .result-card {
            background: var(--secondary);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            transition: transform 0.2s ease;
            min-height: 100px;
        }

        .result-card:hover {
            transform: translateY(-2px);
        }

        .result-card__value {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary);
            margin: 8px 0;
        }

        .result-card__label {
            font-size: 0.85rem;
            color: var(--text-secondary);
            line-height: 1.3;
        }

        .result-card__hint {
            font-size: 0.7rem;
            color: var(--text-secondary);
            margin-top: 4px;
            line-height: 1.2;
        }

        .milestones-section {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 6px;
            box-shadow: var(--shadow);
        }

        .milestones-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .milestone-card {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border-radius: 12px;
            padding: 20px;
            border-left: 4px solid var(--primary);
        }

        .milestone-card__title {
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--primary);
        }

        .milestone-card__value {
            font-size: 1.2rem;
            font-weight: 700;
        }

        .plan-section {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: var(--shadow);
        }

        .plan-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .plan-table__header {
            background: var(--secondary);
            padding: 12px 16px;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid var(--border);
        }

        .plan-table__cell {
            padding: 12px 16px;
            border-bottom: 1px solid var(--border);
        }

        .plan-table__row:hover {
            background: var(--secondary);
        }

        .plan-table__cell--cumulative {
            font-weight: 600;
        }

        .plan-table__cell--positive {
            color: var(--success);
        }

        .plan-table__cell--negative {
            color: var(--danger);
        }

        /* Responsive design */
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }

            .input-group__row {
                grid-template-columns: 1fr;
            }

            .input-grid {
                grid-template-columns: 1fr;
                gap: 0;
            }

            .input-group {
                margin-bottom: 15px;
            }

            .results-grid {
                grid-template-columns: 1fr 1fr;
                gap: 10px;
            }

            .milestones-grid {
                grid-template-columns: 1fr;
            }
            
            .result-card {
                padding: 12px;
                min-height: 90px;
            }
            
            .result-value {
                font-size: 1.1rem;
                margin: 6px 0;
            }
        }

        @media (max-width: 480px) {
            .results-grid {
                grid-template-columns: 1fr;
                gap: 8px;
            }

            body {
                padding: 10px;
            }

            .input-section, .results-section, .milestones-section, .plan-section {
                padding: 20px 15px;
            }
            
            .result-card {
                padding: 10px;
                min-height: 80px;
            }
            
            .result-value {
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="header__title" id="title">Investment Calculator</h1>
            <div class="header__actions">
                <div class="header__badges">
                    <a href="https://github.com/shtormish/RevCalc/" target="_blank" rel="noopener noreferrer">
                        <img src="https://img.shields.io/github/stars/shtormish/RevCalc?style=social" alt="GitHub Stars">
                    </a>
                    <a href="https://github.com/shtormish/RevCalc/blob/main/LICENSE" target="_blank" rel="noopener noreferrer">
                        <img src="https://img.shields.io/badge/License-MIT-blue" alt="License: MIT">
                    </a>
                </div>
                <button class="header__button" id="languageToggle">RU</button>
            </div>
        </div>

        <div class="calculator">
            <div class="input-section">
                <h2 class="section__title">Input Parameters</h2>
                <div class="input-grid">
                    <div class="input-group">
                        <label class="input-group__label" id="initialAmountLabel">Initial Investment Amount</label>
                        <input type="number" class="input-group__field" id="initialAmount" value="10000" min="0">
                        <div class="input-group__hint" id="initialAmountHint">The starting amount of your investment. This is the base amount that will earn interest over time.</div>
                    </div>

                    <div class="input-group">
                        <label class="input-group__label" id="interestRateLabel">Annual Interest Rate (%)</label>
                        <input type="number" class="input-group__field" id="interestRate" value="8" min="0" max="100" step="0.1">
                        <div class="input-group__hint" id="interestRateHint">The annual percentage rate at which your investment will grow. Higher rates mean faster growth.</div>
                    </div>

                    <div class="input-group">
                        <label class="input-group__label" id="compoundingLabel">Compounding Period</label>
                        <select class="input-group__field" id="compounding">
                            <option value="0">No Compounding</option>
                            <option value="1">Daily</option>
                            <option value="30">Monthly</option>
                            <option value="90">Quarterly</option>
                            <option value="180">Semi-Annually</option>
                            <option value="365" selected>Annually</option>
                        </select>
                        <div class="input-group__hint" id="compoundingHint">How often interest is added to your principal. More frequent compounding leads to higher returns.</div>
                    </div>

                    <div class="input-group">
                        <label class="input-group__label" id="investmentTermLabel">Investment Term</label>
                        <div class="input-group__row">
                            <input type="number" class="input-group__field" id="investmentTerm" value="10" min="0">
                            <select class="input-group__field" id="termUnit">
                                <option value="1">Days</option>
                                <option value="30">Months</option>
                                <option value="365" selected>Years</option>
                            </select>
                        </div>
                        <div class="input-group__hint" id="investmentTermHint">The duration of your investment. Longer terms generally lead to higher returns due to compounding.</div>
                    </div>

                    <div class="input-group">
                        <label class="input-group__label" id="additionalInvestmentLabel">Additional Investment</label>
                        <div class="input-group__row">
                            <input type="number" class="input-group__field" id="additionalAmount" value="0" min="0">
                            <select class="input-group__field" id="additionalFrequency">
                                <option value="0">No Additional</option>
                                <option value="1">Daily</option>
                                <option value="30" selected>Monthly</option>
                                <option value="90">Quarterly</option>
                                <option value="365">Annually</option>
                            </select>
                        </div>
                        <div class="input-group__hint" id="additionalInvestmentHint">Regular additional investments can significantly boost your final amount through dollar-cost averaging.</div>
                    </div>

                    <div class="input-group">
                        <label class="input-group__label" id="targetMonthlyIncomeLabel">Target Monthly Income (X)</label>
                        <input type="number" class="input-group__field" id="targetMonthlyIncome" value="1000" min="0">
                        <div class="input-group__hint" id="targetMonthlyIncomeHint">The monthly income you want to achieve from your investment. This helps plan for financial goals.</div>
                    </div>
                </div>
            </div>

            <div class="results-section">
                <h2 class="section__title">Calculated Results</h2>
                <div class="results-grid">
                    <div class="result-card">
                        <div class="result-card__label" id="finalAmountLabel">Final Amount</div>
                        <div class="result-card__value" id="finalAmountValue">0</div>
                        <div class="result-card__hint" id="finalAmountHint">Total amount at the end of investment period including all profits</div>
                    </div>
                    <div class="result-card">
                        <div class="result-card__label" id="totalProfitLabel">Total Profit</div>
                        <div class="result-card__value" id="totalProfitValue">0</div>
                        <div class="result-card__hint" id="totalProfitHint">Absolute profit and percentage gain over the entire period</div>
                    </div>
                    <div class="result-card">
                        <div class="result-card__label" id="effectiveRateLabel">Effective Rate</div>
                        <div class="result-card__value" id="effectiveRateValue">0%</div>
                        <div class="result-card__hint" id="effectiveRateHint">Actual annualized return considering compounding effect</div>
                    </div>
                    <div class="result-card">
                        <div class="result-card__label" id="theoreticalMonthlyIncomeLabel">Theoretical Monthly Income</div>
                        <div class="result-card__value" id="theoreticalMonthlyIncomeValue">0</div>
                        <div class="result-card__hint" id="theoreticalMonthlyIncomeHint">Monthly income if withdrawing interest from final amount</div>
                    </div>
                    <div class="result-card">
                        <div class="result-card__label" id="averageMonthlyProfitLabel">Avg Monthly Profit</div>
                        <div class="result-card__value" id="averageMonthlyProfitValue">0</div>
                        <div class="result-card__hint" id="averageMonthlyProfitHint">Average monthly capital growth during investment period</div>
                    </div>
                    <div class="result-card">
                        <div class="result-card__label" id="averageAnnualProfitLabel">Avg Annual Profit</div>
                        <div class="result-card__value" id="averageAnnualProfitValue">0</div>
                        <div class="result-card__hint" id="averageAnnualProfitHint">Average annual capital growth during investment period</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="milestones-section">
            <h2 class="section__title">Key Milestones</h2>
            <div class="milestones-grid">
                <div class="milestone-card">
                    <div class="milestone-card__title" id="doubleLabel">Double Investment</div>
                    <div class="milestone-card__value" id="doubleValue">0 years</div>
                </div>
                <div class="milestone-card">
                    <div class="milestone-card__title" id="tenfoldLabel">Tenfold Investment</div>
                    <div class="milestone-card__value" id="tenfoldValue">0 years</div>
                </div>
                <div class="milestone-card">
                    <div class="milestone-card__title" id="hundredfoldLabel">Hundredfold Investment</div>
                    <div class="milestone-card__value" id="hundredfoldValue">0 years</div>
                </div>
                <div class="milestone-card">
                    <div class="milestone-card__title" id="targetIncomeLabel">Target Monthly Income</div>
                    <div class="milestone-card__value" id="targetIncomeValue">0 years</div>
                </div>
            </div>
        </div>

        <div class="plan-section">
            <h2 class="section__title">Monthly Income Plan</h2>
            <div>
                <table class="plan-table">
                    <thead>
                        <tr class="plan-table__row">
                            <th class="plan-table__header" id="monthLabel">Month</th>
                            <th class="plan-table__header" id="cumulativeAmountLabel">Cumulative Amount</th>
                            <th class="plan-table__header" id="monthlyIncomeLabel">Monthly Income</th>
                            <th class="plan-table__header" id="monthlyPercentageLabel">% of Initial</th>
                        </tr>
                    </thead>
                    <tbody id="planTableBody">
                        <!-- Generated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // Format number with K/M suffixes for brevity.
        function formatNumber(num) {
            if (Math.abs(num) > 999999) {
                return (num / 1000000).toFixed(2) + 'M';
            }
            if (Math.abs(num) > 999) {
                return (num / 1000).toFixed(1) + 'K';
            }
            return num.toFixed(2);
        }

        // Format a period of days into a human-readable string (e.g., "1 year 2 months 3 days").
        // This version includes improved pluralization for both English and Russian.
        function formatTimePeriod(days, lang = 'en') {
            if (!days || days <= 0) {
                return lang === 'en' ? 'Never' : 'ÐÐ¸ÐºÐ¾Ð³Ð´Ð°';
            }

            const years = Math.floor(days / 365);
            const months = Math.floor((days % 365) / 30);
            const remainingDays = Math.round(days - (years * 365) - (months * 30));

            const parts = [];

            if (lang === 'en') {
                if (years > 0) parts.push(`${years} ${years === 1 ? 'year' : 'years'}`);
                if (months > 0) parts.push(`${months} ${months === 1 ? 'month' : 'months'}`);
                if (remainingDays > 0) parts.push(`${remainingDays} ${remainingDays === 1 ? 'day' : 'days'}`);
            } else { // ru
                const pluralize = (count, forms) => { // [one, few, many] e.g. ['Ð³Ð¾Ð´', 'Ð³Ð¾Ð´Ð°', 'Ð»ÐµÑ‚']
                    const n = Math.abs(count) % 100;
                    const n1 = n % 10;
                    if (n > 10 && n < 20) return forms[2];
                    if (n1 > 1 && n1 < 5) return forms[1];
                    if (n1 === 1) return forms[0];
                    return forms[2];
                };
                if (years > 0) parts.push(`${years} ${pluralize(years, ['Ð³Ð¾Ð´', 'Ð³Ð¾Ð´Ð°', 'Ð»ÐµÑ‚'])}`);
                if (months > 0) parts.push(`${months} ${pluralize(months, ['Ð¼ÐµÑÑÑ†', 'Ð¼ÐµÑÑÑ†Ð°', 'Ð¼ÐµÑÑÑ†ÐµÐ²'])}`);
                if (remainingDays > 0) parts.push(`${remainingDays} ${pluralize(remainingDays, ['Ð´ÐµÐ½ÑŒ', 'Ð´Ð½Ñ', 'Ð´Ð½ÐµÐ¹'])}`);
            }

            return parts.length > 0 ? parts.join(' ') : (lang === 'en' ? '0 days' : '0 Ð´Ð½ÐµÐ¹');
        }

        // Calculate compound interest using a daily simulation model.
        function calculateCompoundInterest(principal, rate, compoundingDays, termDays, additionalAmount, additionalFrequency) {
            const annualRate = rate / 100;

            // No compounding - simple interest
            if (compoundingDays === 0) {
                const simpleInterest = principal * annualRate * (termDays / 365);
                let amount = principal + simpleInterest;

                if (additionalFrequency > 0 && additionalAmount > 0) {
                    const numberOfAdditionalInvestments = Math.floor(termDays / additionalFrequency);
                    amount += additionalAmount * numberOfAdditionalInvestments;
                }
                return amount;
            }

            // With compounding
            let amount = principal;
            const dailyRate = annualRate / 365;

            for (let day = 1; day <= termDays; day++) {
                if (additionalFrequency > 0 && day % additionalFrequency === 0) {
                    amount += additionalAmount;
                }
                if (day % compoundingDays === 0) {
                    const periodRate = dailyRate * compoundingDays;
                    amount *= (1 + periodRate);
                }
            }
            return amount;
        }

        // Calculate a month-by-month breakdown of the investment growth.
        function calculateMonthlyPlan(principal, rate, compoundingDays, termDays, additionalAmount, additionalFrequency) {
            const annualRate = rate / 100;
            const dailyRate = annualRate / 365;
            let amount = principal;
            const monthlyData = [];
            let previousMonthAmount = principal;

            for (let month = 1; month <= Math.ceil(termDays / 30); month++) {
                const startDay = (month - 1) * 30 + 1;
                const endDay = Math.min(month * 30, termDays);

                for (let day = startDay; day <= endDay; day++) {
                    if (additionalFrequency > 0 && day % additionalFrequency === 0) {
                        amount += additionalAmount;
                    }
                    if (compoundingDays > 0 && day % compoundingDays === 0) {
                        const periodRate = dailyRate * compoundingDays;
                        amount *= (1 + periodRate);
                    }
                }

                const monthlyIncome = amount - previousMonthAmount;
                monthlyData.push({
                    month: month,
                    cumulativeAmount: amount,
                    monthlyIncome: monthlyIncome,
                    percentageOfInitial: principal > 0 ? (monthlyIncome / principal) * 100 : 0
                });
                previousMonthAmount = amount;
            }
            return monthlyData;
        }

        // Calculate the effective annual rate (CAGR).
        function calculateEffectiveRate(principal, finalAmount, termDays) {
            if (termDays <= 0 || principal <= 0 || finalAmount <= principal) return 0;
            const totalGrowthFactor = finalAmount / principal;
            const effectiveRate = (Math.pow(totalGrowthFactor, 365 / termDays) - 1) * 100;
            return effectiveRate;
        }

        // Calculate average monthly and annual profits.
        function calculateAverageProfits(principal, finalAmount, termDays) {
            if (termDays <= 0) return { monthly: 0, annual: 0, monthlyPercent: 0, annualPercent: 0 };

            const totalProfit = finalAmount - principal;
            const years = termDays / 365;
            const months = years * 12;

            const averageMonthlyProfit = months > 0 ? totalProfit / months : 0;
            const averageAnnualProfit = years > 0 ? totalProfit / years : 0;
            const averageMonthlyPercent = principal > 0 && months > 0 ? (totalProfit / principal) * 100 / months : 0;
            const averageAnnualPercent = principal > 0 && years > 0 ? (totalProfit / principal) * 100 / years : 0;

            return {
                monthly: averageMonthlyProfit,
                annual: averageAnnualProfit,
                monthlyPercent: averageMonthlyPercent,
                annualPercent: averageAnnualPercent
            };
        }

        // Calculate key investment milestones.
        function calculateMilestones(principal, rate, compoundingDays, additionalAmount, additionalFrequency, targetIncome) {
            const annualRate = rate / 100;
            const dailyRate = annualRate / 365;
            let amount = principal;
            let daysToDouble = 0, daysToTenfold = 0, daysToHundredfold = 0, daysToTargetIncome = 0;

            // Limit search to 100 years to prevent infinite loops
            for (let day = 1; day <= 365 * 100; day++) {
                if (additionalFrequency > 0 && day % additionalFrequency === 0) amount += additionalAmount;

                if (compoundingDays > 0 && day % compoundingDays === 0) {
                    amount *= (1 + dailyRate * compoundingDays);
                } else if (compoundingDays === 0) {
                    amount += principal * dailyRate; // Simple interest
                }

                if (daysToDouble === 0 && principal > 0 && amount >= principal * 2) daysToDouble = day;
                if (daysToTenfold === 0 && principal > 0 && amount >= principal * 10) daysToTenfold = day;
                if (daysToHundredfold === 0 && principal > 0 && amount >= principal * 100) daysToHundredfold = day;
                if (daysToTargetIncome === 0 && targetIncome > 0 && (amount * annualRate / 12) >= targetIncome) daysToTargetIncome = day;

                if (daysToDouble && daysToTenfold && daysToHundredfold && (daysToTargetIncome || targetIncome <= 0)) break;
            }

            return { double: daysToDouble, tenfold: daysToTenfold, hundredfold: daysToHundredfold, targetIncome: daysToTargetIncome };
        }

        // Translation dictionaries
        const translations = {
            en: {
                title: "Investment Calculator",
                inputParameters: "Input Parameters",
                initialAmount: "Initial Investment Amount",
                initialAmountHint: "The starting amount of your investment. This is the base amount that will earn interest over time.",
                interestRate: "Annual Interest Rate (%)",
                interestRateHint: "The annual percentage rate at which your investment will grow. Higher rates mean faster growth.",
                compounding: "Compounding Period",
                compoundingHint: "How often interest is added to your principal. More frequent compounding leads to higher returns.",
                investmentTerm: "Investment Term",
                investmentTermHint: "The duration of your investment. Longer terms generally lead to higher returns due to compounding.",
                additionalInvestment: "Additional Investment",
                additionalInvestmentHint: "Regular additional investments can significantly boost your final amount through dollar-cost averaging.",
                targetMonthlyIncome: "Target Monthly Income (X)",
                targetMonthlyIncomeHint: "The monthly income you want to achieve from your investment. This helps plan for financial goals.",
                calculatedResults: "Calculated Results",
                finalAmount: "Final Amount",
                finalAmountHint: "Total amount at the end of investment period including all profits",
                totalProfit: "Total Profit",
                totalProfitHint: "Absolute profit and percentage gain over the entire period",
                effectiveRate: "Effective Rate",
                effectiveRateHint: "Actual annualized return considering compounding effect",
                theoreticalMonthlyIncome: "Theoretical Monthly Income",
                theoreticalMonthlyIncomeHint: "Monthly income if withdrawing interest from final amount",
                averageMonthlyProfit: "Avg Monthly Profit",
                averageMonthlyProfitHint: "Average monthly capital growth during investment period",
                averageAnnualProfit: "Avg Annual Profit",
                averageAnnualProfitHint: "Average annual capital growth during investment period",
                keyMilestones: "Key Milestones",
                doubleInvestment: "Double Investment",
                tenfoldInvestment: "Tenfold Investment",
                hundredfoldInvestment: "Hundredfold Investment",
                targetMonthlyIncomeMilestone: "Target Monthly Income",
                monthlyIncomePlan: "Monthly Income Plan",
                month: "Month",
                cumulativeAmount: "Cumulative Amount",
                monthlyIncome: "Monthly Income",
                monthlyPercentage: "% of Initial",
                noCompounding: "No Compounding",
                daily: "Daily",
                monthly: "Monthly",
                quarterly: "Quarterly",
                semiAnnually: "Semi-Annually",
                annually: "Annually",
                days: "Days",
                months: "Months",
                years: "Years",
                noAdditional: "No Additional",
                double: "Double",
                tenfold: "Tenfold",
                hundredfold: "Hundredfold"
            },
            ru: {
                title: "ÐšÐ°Ð»ÑŒÐºÑƒÐ»ÑÑ‚Ð¾Ñ€ Ð˜Ð½Ð²ÐµcÑ‚Ð¸Ñ†Ð¸Ð¹",
                inputParameters: "Ð’Ñ…Ð¾Ð´Ð½Ñ‹Ðµ ÐŸÐ°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹",
                initialAmount: "ÐÐ°Ñ‡Ð°Ð»ÑŒÐ½Ð°Ñ cÑƒÐ¼Ð¼Ð° Ð˜Ð½Ð²ÐµcÑ‚Ð¸Ñ†Ð¸Ð¹",
                initialAmountHint: "Ð¡Ñ‚Ð°Ñ€Ñ‚Ð¾Ð²Ð°Ñ cÑƒÐ¼Ð¼Ð° Ð²Ð°ÑˆÐµÐ³Ð¾ Ð²Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ. Ð­Ñ‚Ð¾ Ð±Ð°Ð·Ð¾Ð²Ð°Ñ cÑƒÐ¼Ð¼Ð°, ÐºÐ¾Ñ‚Ð¾Ñ€Ð°Ñ Ð±ÑƒÐ´ÐµÑ‚ Ð¿Ñ€Ð¸Ð½Ð¾cÐ¸Ñ‚ÑŒ Ð¿Ñ€Ð¾Ñ†ÐµÐ½Ñ‚Ñ‹ co Ð²Ñ€ÐµÐ¼ÐµÐ½ÐµÐ¼.",
                interestRate: "Ð“Ð¾Ð´Ð¾Ð²Ð°Ñ ÐŸÑ€Ð¾Ñ†ÐµÐ½Ñ‚Ð½Ð°Ñ cÑ‚Ð°Ð²ÐºÐ° (%)",
                interestRateHint: "Ð“Ð¾Ð´Ð¾Ð²Ð¾Ð¹ Ð¿Ñ€Ð¾Ñ†ÐµÐ½Ñ‚, Ð¿Ð¾ ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð¼Ñƒ Ð±ÑƒÐ´ÐµÑ‚ Ñ€Ð°cÑ‚Ð¸ Ð²Ð°ÑˆÐµ Ð²Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ. Ð‘Ð¾Ð»ÐµÐµ Ð²Ñ‹cÐ¾ÐºÐ¸Ðµ cÑ‚Ð°Ð²ÐºÐ¸ Ð¾Ð·Ð½Ð°Ñ‡Ð°ÑŽÑ‚ Ð±Ð¾Ð»ÐµÐµ Ð±Ñ‹cÑ‚Ñ€Ñ‹Ð¹ Ñ€Ð¾cÑ‚.",
                compounding: "ÐŸÐµÑ€Ð¸Ð¾Ð´ ÐšÐ°Ð¿Ð¸Ñ‚Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸",
                compoundingHint: "ÐšÐ°Ðº Ñ‡Ð°cÑ‚Ð¾ Ð¿Ñ€Ð¾Ñ†ÐµÐ½Ñ‚Ñ‹ Ð´Ð¾Ð±Ð°Ð²Ð»ÑÑŽÑ‚cÑ Ðº Ð¾cÐ½Ð¾Ð²Ð½Ð¾Ð¹ cÑƒÐ¼Ð¼Ðµ. Ð‘Ð¾Ð»ÐµÐµ Ñ‡Ð°cÑ‚Ð°Ñ ÐºÐ°Ð¿Ð¸Ñ‚Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¿Ñ€Ð¸Ð²Ð¾Ð´Ð¸Ñ‚ Ðº Ð±Ð¾Ð»ÐµÐµ Ð²Ñ‹cÐ¾ÐºÐ¾Ð¹ Ð´Ð¾Ñ…Ð¾Ð´Ð½Ð¾cÑ‚Ð¸.",
                investmentTerm: "Ð¡Ñ€Ð¾Ðº Ð˜Ð½Ð²ÐµcÑ‚Ð¸Ñ†Ð¸Ð¹",
                investmentTermHint: "ÐŸÑ€Ð¾Ð´Ð¾Ð»Ð¶Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾cÑ‚ÑŒ Ð²Ð°ÑˆÐµÐ³Ð¾ Ð²Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ. Ð‘Ð¾Ð»ÐµÐµ Ð´Ð»Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ cÑ€Ð¾ÐºÐ¸ Ð¾Ð±Ñ‹Ñ‡Ð½Ð¾ Ð¿Ñ€Ð¸Ð²Ð¾Ð´ÑÑ‚ Ðº Ð±Ð¾Ð»ÐµÐµ Ð²Ñ‹cÐ¾ÐºÐ¾Ð¹ Ð´Ð¾Ñ…Ð¾Ð´Ð½Ð¾cÑ‚Ð¸ Ð±Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€Ñ ÐºÐ°Ð¿Ð¸Ñ‚Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸.",
                additionalInvestment: "Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð’Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ",
                additionalInvestmentHint: "Ð ÐµÐ³ÑƒÐ»ÑÑ€Ð½Ñ‹Ðµ Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð²Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ Ð¼Ð¾Ð³ÑƒÑ‚ Ð·Ð½Ð°Ñ‡Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ ÑƒÐ²ÐµÐ»Ð¸Ñ‡Ð¸Ñ‚ÑŒ Ð²Ð°ÑˆÑƒ ÐºÐ¾Ð½ÐµÑ‡Ð½ÑƒÑŽ cÑƒÐ¼Ð¼Ñƒ Ð±Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€Ñ ÑƒcÑ€ÐµÐ´Ð½ÐµÐ½Ð¸ÑŽ cÑ‚Ð¾Ð¸Ð¼Ð¾cÑ‚Ð¸.",
                targetMonthlyIncome: "Ð¦ÐµÐ»ÐµÐ²Ð¾Ð¹ ÐœÐµcÑÑ‡Ð½Ñ‹Ð¹ Ð”Ð¾Ñ…Ð¾Ð´ (X)",
                targetMonthlyIncomeHint: "ÐœÐµcÑÑ‡Ð½Ñ‹Ð¹ Ð´Ð¾Ñ…Ð¾Ð´, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð²Ñ‹ Ñ…Ð¾Ñ‚Ð¸Ñ‚Ðµ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð¾Ñ‚ Ð¸Ð½Ð²ÐµcÑ‚Ð¸Ñ†Ð¸Ð¹. Ð­Ñ‚Ð¾ Ð¿Ð¾Ð¼Ð¾Ð³Ð°ÐµÑ‚ Ð¿Ð»Ð°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ñ„Ð¸Ð½Ð°Ð½cÐ¾Ð²Ñ‹Ðµ Ñ†ÐµÐ»Ð¸.",
                calculatedResults: "Ð’Ñ‹Ñ‡Ð¸cÐ»ÑÐµÐ¼Ñ‹Ðµ ÐŸÐ°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹",
                finalAmount: "ÐšÐ¾Ð½ÐµÑ‡Ð½Ð°Ñ cÑƒÐ¼Ð¼Ð°",
                finalAmountHint: "ÐžÐ±Ñ‰Ð°Ñ cÑƒÐ¼Ð¼Ð° Ð² ÐºÐ¾Ð½Ñ†Ðµ Ð¿ÐµÑ€Ð¸Ð¾Ð´Ð° Ð¸Ð½Ð²ÐµÑÑ‚Ð¸Ñ†Ð¸Ð¹, Ð²ÐºÐ»ÑŽÑ‡Ð°Ñ Ð²cÑŽ Ð¿Ñ€Ð¸Ð±Ñ‹Ð»ÑŒ",
                totalProfit: "ÐŸÐ¾Ð»Ð½Ñ‹Ð¹ Ð”Ð¾Ñ…Ð¾Ð´",
                totalProfitHint: "ÐÐ±cÐ¾Ð»ÑŽÑ‚Ð½Ð°Ñ Ð¿Ñ€Ð¸Ð±Ñ‹Ð»ÑŒ Ð¸ Ð¿Ñ€Ð¾Ñ†ÐµÐ½Ñ‚Ð½Ñ‹Ð¹ Ð´Ð¾Ñ…Ð¾Ð´ Ð·Ð° Ð²ÐµcÑŒ Ð¿ÐµÑ€Ð¸Ð¾Ð´",
                effectiveRate: "Ð­Ñ„Ñ„ÐµÐºÑ‚Ð¸Ð²Ð½Ð°Ñ cÑ‚Ð°Ð²ÐºÐ°",
                effectiveRateHint: "Ð¤Ð°ÐºÑ‚Ð¸Ñ‡ÐµcÐºÐ°Ñ Ð³Ð¾Ð´Ð¾Ð²Ð°Ñ Ð´Ð¾Ñ…Ð¾Ð´Ð½Ð¾cÑ‚ÑŒ c ÑƒÑ‡ÐµÑ‚Ð¾Ð¼ ÑÑ„Ñ„ÐµÐºÑ‚Ð° ÐºÐ°Ð¿Ð¸Ñ‚Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸",
                theoreticalMonthlyIncome: "Ð¢ÐµÐ¾Ñ€ÐµÑ‚Ð¸Ñ‡ÐµcÐºÐ¸Ð¹ ÐœÐµcÑÑ‡Ð½Ñ‹Ð¹ Ð”Ð¾Ñ…Ð¾Ð´",
                theoreticalMonthlyIncomeHint: "ÐœÐµcÑÑ‡Ð½Ñ‹Ð¹ Ð´Ð¾Ñ…Ð¾Ð´ Ð¿Ñ€Ð¸ cÐ½ÑÑ‚Ð¸Ð¸ Ð¿Ñ€Ð¾Ñ†ÐµÐ½Ñ‚Ð¾Ð² c Ñ„Ð¸Ð½Ð°Ð»ÑŒÐ½Ð¾Ð¹ cÑƒÐ¼Ð¼Ñ‹",
                averageMonthlyProfit: "Ð¡Ñ€ÐµÐ´Ð½Ð¸Ð¹ ÐœÐµcÑÑ‡Ð½Ñ‹Ð¹ ÐŸÑ€Ð¸Ñ€Ð¾cÑ‚",
                averageMonthlyProfitHint: "Ð¡Ñ€ÐµÐ´Ð½ÐµÐ¼ÐµcÑÑ‡Ð½Ñ‹Ð¹ Ñ€Ð¾cÑ‚ ÐºÐ°Ð¿Ð¸Ñ‚Ð°Ð»Ð° Ð·Ð° Ð¿ÐµÑ€Ð¸Ð¾Ð´ Ð¸Ð½Ð²ÐµcÑ‚Ð¸Ñ†Ð¸Ð¹",
                averageAnnualProfit: "Ð¡Ñ€ÐµÐ´Ð½Ð¸Ð¹ Ð“Ð¾Ð´Ð¾Ð²Ð¾Ð¹ ÐŸÑ€Ð¸Ñ€Ð¾cÑ‚",
                averageAnnualProfitHint: "Ð¡Ñ€ÐµÐ´Ð½ÐµÐ³Ð¾Ð´Ð¾Ð²Ð¾Ð¹ Ñ€Ð¾cÑ‚ ÐºÐ°Ð¿Ð¸Ñ‚Ð°Ð»Ð° Ð·Ð° Ð¿ÐµÑ€Ð¸Ð¾Ð´ Ð¸Ð½Ð²ÐµcÑ‚Ð¸Ñ†Ð¸Ð¹",
                keyMilestones: "ÐšÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ðµ Ð’ÐµÑ…Ð¸",
                doubleInvestment: "Ð£Ð´Ð²Ð¾ÐµÐ½Ð¸Ðµ Ð’ÐºÐ»Ð°Ð´Ð°",
                tenfoldInvestment: "Ð£Ð´ÐµcÑÑ‚ÐµÑ€ÐµÐ½Ð¸Ðµ Ð’ÐºÐ»Ð°Ð´Ð°",
                hundredfoldInvestment: "Ð£Ð²ÐµÐ»Ð¸Ñ‡ÐµÐ½Ð¸Ðµ Ð² 100 Ñ€Ð°Ð·",
                targetMonthlyIncomeMilestone: "Ð¦ÐµÐ»ÐµÐ²Ð¾Ð¹ ÐœÐµcÑÑ‡Ð½Ñ‹Ð¹ Ð”Ð¾Ñ…Ð¾Ð´",
                monthlyIncomePlan: "ÐŸÐ¾Ð¼ÐµcÑÑ‡Ð½Ñ‹Ð¹ ÐŸÐ»Ð°Ð½ Ð”Ð¾Ñ…Ð¾Ð´Ð°",
                month: "ÐœÐµcÑÑ†",
                cumulativeAmount: "ÐÐ°ÐºÐ¾Ð¿Ð»ÐµÐ½Ð½Ð°Ñ cÑƒÐ¼Ð¼Ð°",
                monthlyIncome: "ÐœÐµcÑÑ‡Ð½Ñ‹Ð¹ Ð”Ð¾Ñ…Ð¾Ð´",
                monthlyPercentage: "% Ð¾Ñ‚ ÐÐ°Ñ‡Ð°Ð»ÑŒÐ½Ð¾Ð¹",
                noCompounding: "Ð‘ÐµÐ· ÐšÐ°Ð¿Ð¸Ñ‚Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸",
                daily: "Ð•Ð¶ÐµÐ´Ð½ÐµÐ²Ð½Ð¾",
                monthly: "Ð•Ð¶ÐµÐ¼ÐµcÑÑ‡Ð½Ð¾",
                quarterly: "Ð•Ð¶ÐµÐºÐ²Ð°Ñ€Ñ‚Ð°Ð»ÑŒÐ½Ð¾",
                semiAnnually: "ÐŸÐ¾Ð»ÑƒÐ³Ð¾Ð´Ð¾Ð²Ð¾Ð¹",
                annually: "Ð•Ð¶ÐµÐ³Ð¾Ð´Ð½Ð¾",
                days: "Ð”Ð½Ð¸",
                months: "ÐœÐµcÑÑ†Ñ‹",
                years: "Ð“Ð¾Ð´Ñ‹",
                noAdditional: "Ð‘ÐµÐ· Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ…",
                double: "Ð£Ð´Ð²Ð¾ÐµÐ½Ð¸Ðµ",
                tenfold: "Ð£Ð´ÐµcÑÑ‚ÐµÑ€ÐµÐ½Ð¸Ðµ",
                hundredfold: "Ð£Ð²ÐµÐ»Ð¸Ñ‡ÐµÐ½Ð¸Ðµ Ð² 100 Ñ€Ð°Ð·"
            }
        };

        let currentLanguage = 'en';

        // DOM Elements
        const elements = {
            languageToggle: document.getElementById('languageToggle'),
            initialAmount: document.getElementById('initialAmount'),
            interestRate: document.getElementById('interestRate'),
            compounding: document.getElementById('compounding'),
            investmentTerm: document.getElementById('investmentTerm'),
            termUnit: document.getElementById('termUnit'),
            additionalAmount: document.getElementById('additionalAmount'),
            additionalFrequency: document.getElementById('additionalFrequency'),
            targetMonthlyIncome: document.getElementById('targetMonthlyIncome'),
            finalAmountValue: document.getElementById('finalAmountValue'),
            totalProfitValue: document.getElementById('totalProfitValue'),
            effectiveRateValue: document.getElementById('effectiveRateValue'),
            theoreticalMonthlyIncomeValue: document.getElementById('theoreticalMonthlyIncomeValue'),
            averageMonthlyProfitValue: document.getElementById('averageMonthlyProfitValue'),
            averageAnnualProfitValue: document.getElementById('averageAnnualProfitValue'),
            doubleValue: document.getElementById('doubleValue'),
            tenfoldValue: document.getElementById('tenfoldValue'),
            hundredfoldValue: document.getElementById('hundredfoldValue'),
            targetIncomeValue: document.getElementById('targetIncomeValue'),
            planTableBody: document.getElementById('planTableBody')
        };

        // Translation elements mapping
        const translationElements = {
            title: document.getElementById('title'),
            inputParameters: document.querySelector('.input-section .section-title'),
            initialAmountLabel: document.getElementById('initialAmountLabel'),
            initialAmountHint: document.getElementById('initialAmountHint'),
            interestRateLabel: document.getElementById('interestRateLabel'),
            interestRateHint: document.getElementById('interestRateHint'),
            compoundingLabel: document.getElementById('compoundingLabel'),
            compoundingHint: document.getElementById('compoundingHint'),
            investmentTermLabel: document.getElementById('investmentTermLabel'),
            investmentTermHint: document.getElementById('investmentTermHint'),
            additionalInvestmentLabel: document.getElementById('additionalInvestmentLabel'),
            additionalInvestmentHint: document.getElementById('additionalInvestmentHint'),
            targetMonthlyIncomeLabel: document.getElementById('targetMonthlyIncomeLabel'),
            targetMonthlyIncomeHint: document.getElementById('targetMonthlyIncomeHint'),
            calculatedResults: document.querySelector('.results-section .section-title'),
            finalAmountLabel: document.querySelector('[id="finalAmountLabel"]'),
            finalAmountHint: document.querySelector('[id="finalAmountHint"]'),
            totalProfitLabel: document.querySelector('[id="totalProfitLabel"]'),
            totalProfitHint: document.querySelector('[id="totalProfitHint"]'),
            effectiveRateLabel: document.querySelector('[id="effectiveRateLabel"]'),
            effectiveRateHint: document.querySelector('[id="effectiveRateHint"]'),
            theoreticalMonthlyIncomeLabel: document.querySelector('[id="theoreticalMonthlyIncomeLabel"]'),
            theoreticalMonthlyIncomeHint: document.querySelector('[id="theoreticalMonthlyIncomeHint"]'),
            averageMonthlyProfitLabel: document.querySelector('[id="averageMonthlyProfitLabel"]'),
            averageMonthlyProfitHint: document.querySelector('[id="averageMonthlyProfitHint"]'),
            averageAnnualProfitLabel: document.querySelector('[id="averageAnnualProfitLabel"]'),
            averageAnnualProfitHint: document.querySelector('[id="averageAnnualProfitHint"]'),
            keyMilestones: document.querySelector('.milestones-section .section-title'),
            doubleLabel: document.getElementById('doubleLabel'),
            tenfoldLabel: document.getElementById('tenfoldLabel'),
            hundredfoldLabel: document.getElementById('hundredfoldLabel'),
            targetIncomeLabel: document.getElementById('targetIncomeLabel'),
            monthlyIncomePlan: document.querySelector('.plan-section .section-title'),
            monthLabel: document.getElementById('monthLabel'),
            cumulativeAmountLabel: document.getElementById('cumulativeAmountLabel'),
            monthlyIncomeLabel: document.getElementById('monthlyIncomeLabel'),
            monthlyPercentageLabel: document.getElementById('monthlyPercentageLabel')
        };

        // Initialize compounding options
        function initializeCompoundingOptions() {
            const compoundingOptions = {
                en: [
                    { value: "0", text: "No Compounding" },
                    { value: "1", text: "Daily" },
                    { value: "30", text: "Monthly" },
                    { value: "90", text: "Quarterly" },
                    { value: "180", text: "Semi-Annually" },
                    { value: "365", text: "Annually" }
                ],
                ru: [
                    { value: "0", text: "Ð‘ÐµÐ· ÐšÐ°Ð¿Ð¸Ñ‚Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸" },
                    { value: "1", text: "Ð•Ð¶ÐµÐ´Ð½ÐµÐ²Ð½Ð¾" },
                    { value: "30", text: "Ð•Ð¶ÐµÐ¼ÐµcÑÑ‡Ð½Ð¾" },
                    { value: "90", text: "Ð•Ð¶ÐµÐºÐ²Ð°Ñ€Ñ‚Ð°Ð»ÑŒÐ½Ð¾" },
                    { value: "180", text: "ÐŸÐ¾Ð»ÑƒÐ³Ð¾Ð´Ð¾Ð²Ð¾Ð¹" },
                    { value: "365", text: "Ð•Ð¶ÐµÐ³Ð¾Ð´Ð½Ð¾" }
                ]
            };

            const termUnitOptions = {
                en: [
                    { value: "1", text: "Days" },
                    { value: "30", text: "Months" },
                    { value: "365", text: "Years" }
                ],
                ru: [
                    { value: "1", text: "Ð”Ð½Ð¸" },
                    { value: "30", text: "ÐœÐµcÑÑ†Ñ‹" },
                    { value: "365", text: "Ð“Ð¾Ð´Ñ‹" }
                ]
            };

            const additionalFrequencyOptions = {
                en: [
                    { value: "0", text: "No Additional" },
                    { value: "1", text: "Daily" },
                    { value: "30", text: "Monthly" },
                    { value: "90", text: "Quarterly" },
                    { value: "365", text: "Annually" }
                ],
                ru: [
                    { value: "0", text: "Ð‘ÐµÐ· Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ…" },
                    { value: "1", text: "Ð•Ð¶ÐµÐ´Ð½ÐµÐ²Ð½Ð¾" },
                    { value: "30", text: "Ð•Ð¶ÐµÐ¼ÐµcÑÑ‡Ð½Ð¾" },
                    { value: "90", text: "Ð•Ð¶ÐµÐºÐ²Ð°Ñ€Ñ‚Ð°Ð»ÑŒÐ½Ð¾" },
                    { value: "365", text: "Ð•Ð¶ÐµÐ³Ð¾Ð´Ð½Ð¾" }
                ]
            };

            // Clear and populate compounding options
            elements.compounding.innerHTML = '';
            compoundingOptions[currentLanguage].forEach(option => {
                const opt = document.createElement('option');
                opt.value = option.value;
                opt.textContent = option.text;
                if (option.value === "365") opt.selected = true;
                elements.compounding.appendChild(opt);
            });

            // Clear and populate term unit options
            elements.termUnit.innerHTML = '';
            termUnitOptions[currentLanguage].forEach(option => {
                const opt = document.createElement('option');
                opt.value = option.value;
                opt.textContent = option.text;
                if (option.value === "365") opt.selected = true;
                elements.termUnit.appendChild(opt);
            });

            // Clear and populate additional frequency options
            elements.additionalFrequency.innerHTML = '';
            additionalFrequencyOptions[currentLanguage].forEach(option => {
                const opt = document.createElement('option');
                opt.value = option.value;
                opt.textContent = option.text;
                if (option.value === "30") opt.selected = true;
                elements.additionalFrequency.appendChild(opt);
            });
        }

        // Update calculations
        function updateCalculations() {
            const principal = parseFloat(elements.initialAmount.value) || 0;
            const rate = parseFloat(elements.interestRate.value) || 0;
            const compoundingDays = parseInt(elements.compounding.value) || 0;
            const termValue = parseFloat(elements.investmentTerm.value) || 0;
            const termUnit = parseInt(elements.termUnit.value) || 365;
            const termDays = termValue * termUnit;
            const additionalAmount = parseFloat(elements.additionalAmount.value) || 0;
            const additionalFrequency = parseInt(elements.additionalFrequency.value) || 0;
            const targetIncome = parseFloat(elements.targetMonthlyIncome.value) || 0;

            // Calculate final amount
            const finalAmount = calculateCompoundInterest(principal, rate, compoundingDays, termDays, additionalAmount, additionalFrequency);
            const totalProfit = finalAmount - principal;
            const totalProfitPercentage = principal > 0 ? (totalProfit / principal) * 100 : 0;

            // Calculate effective rate
            const effectiveRate = (compoundingDays > 0 && principal > 0) ? calculateEffectiveRate(principal, finalAmount, termDays) : rate;

            // Calculate theoretical monthly income (from final amount)
            const theoreticalMonthlyIncome = termDays > 0 ? (finalAmount * (rate / 100) / 12) : 0;

            // Calculate average profits
            const averageProfits = calculateAverageProfits(principal, finalAmount, termDays);

            // Update results
            elements.finalAmountValue.textContent = formatNumber(finalAmount);
            elements.totalProfitValue.textContent = formatNumber(totalProfit) + ` (${totalProfitPercentage.toFixed(1)}%)`;
            elements.effectiveRateValue.textContent = effectiveRate.toFixed(2) + '%';
            elements.theoreticalMonthlyIncomeValue.textContent = formatNumber(theoreticalMonthlyIncome);
            elements.averageMonthlyProfitValue.textContent = formatNumber(averageProfits.monthly) + ` (${averageProfits.monthlyPercent.toFixed(2)}%)`;
            elements.averageAnnualProfitValue.textContent = formatNumber(averageProfits.annual) + ` (${averageProfits.annualPercent.toFixed(2)}%)`;

            // Calculate milestones
            const milestones = calculateMilestones(principal, rate, compoundingDays, additionalAmount, additionalFrequency, targetIncome);
            elements.doubleValue.textContent = formatTimePeriod(milestones.double, currentLanguage);
            elements.tenfoldValue.textContent = formatTimePeriod(milestones.tenfold, currentLanguage);
            elements.hundredfoldValue.textContent = formatTimePeriod(milestones.hundredfold, currentLanguage);
            elements.targetIncomeValue.textContent = formatTimePeriod(milestones.targetIncome, currentLanguage);

            // Calculate monthly plan
            const monthlyPlan = calculateMonthlyPlan(principal, rate, compoundingDays, termDays, additionalAmount, additionalFrequency);
            updateMonthlyPlanTable(monthlyPlan, principal);
            renderSvgChart(monthlyPlan);
        }

        // Update monthly plan table
        function updateMonthlyPlanTable(monthlyData, principal) {
            elements.planTableBody.innerHTML = '';
            
            monthlyData.forEach(data => {
                const row = document.createElement('tr');
                row.className = 'plan-table__row';
                row.innerHTML = `
                    <td class="plan-table__cell">${data.month}</td>
                    <td class="plan-table__cell plan-table__cell--cumulative">${formatNumber(data.cumulativeAmount)}</td>
                    <td class="plan-table__cell ${data.monthlyIncome >= 0 ? 'plan-table__cell--positive' : 'plan-table__cell--negative'}">${formatNumber(data.monthlyIncome)}</td>
                    <td class="plan-table__cell">${data.percentageOfInitial.toFixed(2)}%</td>
                `;
                elements.planTableBody.appendChild(row);
            });
        }

        // Translate UI
        function translateUI() {
            const t = translations[currentLanguage];
            
            // Update text content
            translationElements.title.textContent = t.title; // This is already a BEM element: header__title
            document.querySelector('.input-section .section__title').textContent = t.inputParameters;
            document.getElementById('initialAmountLabel').textContent = t.initialAmount;
            document.getElementById('initialAmountHint').textContent = t.initialAmountHint;
            document.getElementById('interestRateLabel').textContent = t.interestRate;
            document.getElementById('interestRateHint').textContent = t.interestRateHint;
            document.getElementById('compoundingLabel').textContent = t.compounding;
            document.getElementById('compoundingHint').textContent = t.compoundingHint;
            document.getElementById('investmentTermLabel').textContent = t.investmentTerm;
            document.getElementById('investmentTermHint').textContent = t.investmentTermHint;
            document.getElementById('additionalInvestmentLabel').textContent = t.additionalInvestment;
            document.getElementById('additionalInvestmentHint').textContent = t.additionalInvestmentHint;
            document.getElementById('targetMonthlyIncomeLabel').textContent = t.targetMonthlyIncome;
            document.getElementById('targetMonthlyIncomeHint').textContent = t.targetMonthlyIncomeHint;
            document.querySelector('.results-section .section__title').textContent = t.calculatedResults;
            document.querySelector('[id="finalAmountLabel"]').textContent = t.finalAmount;
            document.querySelector('[id="finalAmountHint"]').textContent = t.finalAmountHint;
            document.querySelector('[id="totalProfitLabel"]').textContent = t.totalProfit;
            document.querySelector('[id="totalProfitHint"]').textContent = t.totalProfitHint;
            document.querySelector('[id="effectiveRateLabel"]').textContent = t.effectiveRate;
            document.querySelector('[id="effectiveRateHint"]').textContent = t.effectiveRateHint;
            document.querySelector('[id="theoreticalMonthlyIncomeLabel"]').textContent = t.theoreticalMonthlyIncome;
            document.querySelector('[id="theoreticalMonthlyIncomeHint"]').textContent = t.theoreticalMonthlyIncomeHint;
            document.querySelector('[id="averageMonthlyProfitLabel"]').textContent = t.averageMonthlyProfit;
            document.querySelector('[id="averageMonthlyProfitHint"]').textContent = t.averageMonthlyProfitHint;
            document.querySelector('[id="averageAnnualProfitLabel"]').textContent = t.averageAnnualProfit;
            document.querySelector('[id="averageAnnualProfitHint"]').textContent = t.averageAnnualProfitHint;
            document.querySelector('.milestones-section .section__title').textContent = t.keyMilestones;
            document.getElementById('doubleLabel').textContent = t.doubleInvestment;
            document.getElementById('tenfoldLabel').textContent = t.tenfoldInvestment;
            document.getElementById('hundredfoldLabel').textContent = t.hundredfoldInvestment;
            document.getElementById('targetIncomeLabel').textContent = t.targetMonthlyIncomeMilestone;
            document.querySelector('.plan-section .section__title').textContent = t.monthlyIncomePlan;
            document.getElementById('monthLabel').textContent = t.month;
            document.getElementById('cumulativeAmountLabel').textContent = t.cumulativeAmount;
            document.getElementById('monthlyIncomeLabel').textContent = t.monthlyIncome;
            document.getElementById('monthlyPercentageLabel').textContent = t.monthlyPercentage;

            // Update button text
            elements.languageToggle.textContent = currentLanguage === 'en' ? 'RU' : 'EN';

            // Reinitialize options
            initializeCompoundingOptions();
            
            // Recalculate values to update language-dependent text (e.g., milestones)
            updateCalculations();
        }

        // Event listeners
        elements.languageToggle.addEventListener('click', () => {
            currentLanguage = (currentLanguage === 'en') ? 'ru' : 'en';
            translateUI();
        });

        // Add event listeners to all input fields
        Object.values(elements).forEach(element => {
            if (element?.addEventListener) {
                element.addEventListener('input', updateCalculations);
            }
        });

        // Initialize after DOM is fully loaded to ensure correct element dimensions
        document.addEventListener('DOMContentLoaded', () => {
            initializeCompoundingOptions();
            updateCalculations();
        });
    </script>
</body>
</html>