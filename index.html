<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Investment Calculator</title>
    <style>
        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --secondary: #f8fafc;
            --text: #0f172a;
            --text-secondary: #64748b;
            --border: #e2e8f0;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            color: var(--text);
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px;
            background: white;
            border-radius: 16px;
            box-shadow: var(--shadow);
        }

        .header h1 {
            font-size: 2rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .language-toggle {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s ease;
            box-shadow: var(--shadow);
        }

        .language-toggle:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
        }

        .calculator {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        @media (max-width: 768px) {
            .calculator {
                grid-template-columns: 1fr;
            }
        }

        .input-section, .results-section {
            background: white;
            border-radius: 16px;
            padding: 25px;
            box-shadow: var(--shadow);
        }

        .section-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 20px;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            font-size: 0.95rem;
        }

        .input-hint {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: 4px;
            line-height: 1.4;
        }

        .input-field {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.2s ease;
            background: var(--secondary);
        }

        .input-field:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .input-row {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 15px;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
        }

        .result-card {
            background: var(--secondary);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            transition: transform 0.2s ease;
            min-height: 100px;
        }

        .result-card:hover {
            transform: translateY(-2px);
        }

        .result-value {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary);
            margin: 8px 0;
        }

        .result-label {
            font-size: 0.85rem;
            color: var(--text-secondary);
            line-height: 1.3;
        }

        .result-hint {
            font-size: 0.7rem;
            color: var(--text-secondary);
            margin-top: 4px;
            line-height: 1.2;
        }

        .milestones-section {
            background: white;
            border-radius: 16px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
        }

        .milestones-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .milestone-card {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border-radius: 12px;
            padding: 20px;
            border-left: 4px solid var(--primary);
        }

        .milestone-title {
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--primary);
        }

        .milestone-value {
            font-size: 1.2rem;
            font-weight: 700;
        }

        .plan-section {
            background: white;
            border-radius: 16px;
            padding: 25px;
            box-shadow: var(--shadow);
        }

        .plan-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .plan-table th {
            background: var(--secondary);
            padding: 12px 16px;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid var(--border);
        }

        .plan-table td {
            padding: 12px 16px;
            border-bottom: 1px solid var(--border);
        }

        .plan-table tr:hover {
            background: var(--secondary);
        }

        .cumulative {
            font-weight: 600;
        }

        .positive {
            color: var(--success);
        }

        .negative {
            color: var(--danger);
        }

        .scrollable {
            max-height: 300px;
            overflow-y: auto;
        }

        /* Custom scrollbar */
        .scrollable::-webkit-scrollbar {
            width: 6px;
        }

        .scrollable::-webkit-scrollbar-track {
            background: var(--secondary);
            border-radius: 3px;
        }

        .scrollable::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 3px;
        }

        /* Responsive design */
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }

            .input-row {
                grid-template-columns: 1fr;
            }

            .results-grid {
                grid-template-columns: 1fr 1fr;
                gap: 10px;
            }

            .milestones-grid {
                grid-template-columns: 1fr;
            }
            
            .result-card {
                padding: 12px;
                min-height: 90px;
            }
            
            .result-value {
                font-size: 1.1rem;
                margin: 6px 0;
            }
        }

        @media (max-width: 480px) {
            .results-grid {
                grid-template-columns: 1fr;
                gap: 8px;
            }

            body {
                padding: 10px;
            }

            .input-section, .results-section, .milestones-section, .plan-section {
                padding: 20px 15px;
            }
            
            .result-card {
                padding: 10px;
                min-height: 80px;
            }
            
            .result-value {
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Investment Calculator</h1>
            <button class="language-toggle" id="languageToggle">RU</button>
        </div>

        <div class="calculator">
            <div class="input-section">
                <h2 class="section-title">Input Parameters</h2>
                <div class="input-group">
                    <label class="input-label" id="initialAmountLabel">Initial Investment Amount</label>
                    <input type="number" class="input-field" id="initialAmount" value="10000" min="0">
                    <div class="input-hint" id="initialAmountHint">The starting amount of your investment. This is the base amount that will earn interest over time.</div>
                </div>

                <div class="input-group">
                    <label class="input-label" id="interestRateLabel">Annual Interest Rate (%)</label>
                    <input type="number" class="input-field" id="interestRate" value="8" min="0" max="100" step="0.1">
                    <div class="input-hint" id="interestRateHint">The annual percentage rate at which your investment will grow. Higher rates mean faster growth.</div>
                </div>

                <div class="input-group">
                    <label class="input-label" id="compoundingLabel">Compounding Period</label>
                    <select class="input-field" id="compounding">
                        <option value="0">No Compounding</option>
                        <option value="1">Daily</option>
                        <option value="30">Monthly</option>
                        <option value="90">Quarterly</option>
                        <option value="180">Semi-Annually</option>
                        <option value="365" selected>Annually</option>
                    </select>
                    <div class="input-hint" id="compoundingHint">How often interest is added to your principal. More frequent compounding leads to higher returns.</div>
                </div>

                <div class="input-group">
                    <label class="input-label" id="investmentTermLabel">Investment Term</label>
                    <div class="input-row">
                        <input type="number" class="input-field" id="investmentTerm" value="10" min="0">
                        <select class="input-field" id="termUnit">
                            <option value="1">Days</option>
                            <option value="30">Months</option>
                            <option value="365" selected>Years</option>
                        </select>
                    </div>
                    <div class="input-hint" id="investmentTermHint">The duration of your investment. Longer terms generally lead to higher returns due to compounding.</div>
                </div>

                <div class="input-group">
                    <label class="input-label" id="additionalInvestmentLabel">Additional Investment</label>
                    <div class="input-row">
                        <input type="number" class="input-field" id="additionalAmount" value="0" min="0">
                        <select class="input-field" id="additionalFrequency">
                            <option value="0">No Additional</option>
                            <option value="1">Daily</option>
                            <option value="30" selected>Monthly</option>
                            <option value="90">Quarterly</option>
                            <option value="365">Annually</option>
                        </select>
                    </div>
                    <div class="input-hint" id="additionalInvestmentHint">Regular additional investments can significantly boost your final amount through dollar-cost averaging.</div>
                </div>

                <div class="input-group">
                    <label class="input-label" id="targetMonthlyIncomeLabel">Target Monthly Income (X)</label>
                    <input type="number" class="input-field" id="targetMonthlyIncome" value="1000" min="0">
                    <div class="input-hint" id="targetMonthlyIncomeHint">The monthly income you want to achieve from your investment. This helps plan for financial goals.</div>
                </div>
            </div>

            <div class="results-section">
                <h2 class="section-title">Calculated Results</h2>
                <div class="results-grid">
                    <div class="result-card">
                        <div class="result-label" id="finalAmountLabel">Final Amount</div>
                        <div class="result-value" id="finalAmountValue">0</div>
                        <div class="result-hint" id="finalAmountHint">Total amount at the end of investment period including all profits</div>
                    </div>
                    <div class="result-card">
                        <div class="result-label" id="totalProfitLabel">Total Profit</div>
                        <div class="result-value" id="totalProfitValue">0</div>
                        <div class="result-hint" id="totalProfitHint">Absolute profit and percentage gain over the entire period</div>
                    </div>
                    <div class="result-card">
                        <div class="result-label" id="effectiveRateLabel">Effective Rate</div>
                        <div class="result-value" id="effectiveRateValue">0%</div>
                        <div class="result-hint" id="effectiveRateHint">Actual annualized return considering compounding effect</div>
                    </div>
                    <div class="result-card">
                        <div class="result-label" id="theoreticalMonthlyIncomeLabel">Theoretical Monthly Income</div>
                        <div class="result-value" id="theoreticalMonthlyIncomeValue">0</div>
                        <div class="result-hint" id="theoreticalMonthlyIncomeHint">Monthly income if withdrawing interest from final amount</div>
                    </div>
                    <div class="result-card">
                        <div class="result-label" id="averageMonthlyProfitLabel">Avg Monthly Profit</div>
                        <div class="result-value" id="averageMonthlyProfitValue">0</div>
                        <div class="result-hint" id="averageMonthlyProfitHint">Average monthly capital growth during investment period</div>
                    </div>
                    <div class="result-card">
                        <div class="result-label" id="averageAnnualProfitLabel">Avg Annual Profit</div>
                        <div class="result-value" id="averageAnnualProfitValue">0</div>
                        <div class="result-hint" id="averageAnnualProfitHint">Average annual capital growth during investment period</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="milestones-section">
            <h2 class="section-title">Key Milestones</h2>
            <div class="milestones-grid">
                <div class="milestone-card">
                    <div class="milestone-title" id="doubleLabel">Double Investment</div>
                    <div class="milestone-value" id="doubleValue">0 years</div>
                </div>
                <div class="milestone-card">
                    <div class="milestone-title" id="tenfoldLabel">Tenfold Investment</div>
                    <div class="milestone-value" id="tenfoldValue">0 years</div>
                </div>
                <div class="milestone-card">
                    <div class="milestone-title" id="hundredfoldLabel">Hundredfold Investment</div>
                    <div class="milestone-value" id="hundredfoldValue">0 years</div>
                </div>
                <div class="milestone-card">
                    <div class="milestone-title" id="targetIncomeLabel">Target Monthly Income</div>
                    <div class="milestone-value" id="targetIncomeValue">0 years</div>
                </div>
            </div>
        </div>

        <div class="plan-section">
            <h2 class="section-title">Monthly Income Plan</h2>
            <div class="scrollable">
                <table class="plan-table">
                    <thead>
                        <tr>
                            <th id="monthLabel">Month</th>
                            <th id="cumulativeAmountLabel">Cumulative Amount</th>
                            <th id="monthlyIncomeLabel">Monthly Income</th>
                            <th id="monthlyPercentageLabel">% of Initial</th>
                        </tr>
                    </thead>
                    <tbody id="planTableBody">
                        <!-- Generated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // Translation dictionaries
        const translations = {
            en: {
                title: "Investment Calculator",
                inputParameters: "Input Parameters",
                initialAmount: "Initial Investment Amount",
                initialAmountHint: "The starting amount of your investment. This is the base amount that will earn interest over time.",
                interestRate: "Annual Interest Rate (%)",
                interestRateHint: "The annual percentage rate at which your investment will grow. Higher rates mean faster growth.",
                compounding: "Compounding Period",
                compoundingHint: "How often interest is added to your principal. More frequent compounding leads to higher returns.",
                investmentTerm: "Investment Term",
                investmentTermHint: "The duration of your investment. Longer terms generally lead to higher returns due to compounding.",
                additionalInvestment: "Additional Investment",
                additionalInvestmentHint: "Regular additional investments can significantly boost your final amount through dollar-cost averaging.",
                targetMonthlyIncome: "Target Monthly Income (X)",
                targetMonthlyIncomeHint: "The monthly income you want to achieve from your investment. This helps plan for financial goals.",
                calculatedResults: "Calculated Results",
                finalAmount: "Final Amount",
                finalAmountHint: "Total amount at the end of investment period including all profits",
                totalProfit: "Total Profit",
                totalProfitHint: "Absolute profit and percentage gain over the entire period",
                effectiveRate: "Effective Rate",
                effectiveRateHint: "Actual annualized return considering compounding effect",
                theoreticalMonthlyIncome: "Theoretical Monthly Income",
                theoreticalMonthlyIncomeHint: "Monthly income if withdrawing interest from final amount",
                averageMonthlyProfit: "Avg Monthly Profit",
                averageMonthlyProfitHint: "Average monthly capital growth during investment period",
                averageAnnualProfit: "Avg Annual Profit",
                averageAnnualProfitHint: "Average annual capital growth during investment period",
                keyMilestones: "Key Milestones",
                doubleInvestment: "Double Investment",
                tenfoldInvestment: "Tenfold Investment",
                hundredfoldInvestment: "Hundredfold Investment",
                targetMonthlyIncomeMilestone: "Target Monthly Income",
                monthlyIncomePlan: "Monthly Income Plan",
                month: "Month",
                cumulativeAmount: "Cumulative Amount",
                monthlyIncome: "Monthly Income",
                monthlyPercentage: "% of Initial",
                noCompounding: "No Compounding",
                daily: "Daily",
                monthly: "Monthly",
                quarterly: "Quarterly",
                semiAnnually: "Semi-Annually",
                annually: "Annually",
                days: "Days",
                months: "Months",
                years: "Years",
                noAdditional: "No Additional",
                double: "Double",
                tenfold: "Tenfold",
                hundredfold: "Hundredfold"
            },
            ru: {
                title: "Калькулятор Инвестиций",
                inputParameters: "Входные Параметры",
                initialAmount: "Начальная Сумма Инвестиций",
                initialAmountHint: "Стартовая сумма вашего вложения. Это базовая сумма, которая будет приносить проценты co временем.",
                interestRate: "Годовая Процентная Ставка (%)",
                interestRateHint: "Годовой процент, по которому будет расти ваше вложение. Более высокие ставки означают более быстрый рост.",
                compounding: "Период Капитализации",
                compoundingHint: "Как часто проценты добавляются к основной сумме. Более частая капитализация приводит к более высокой доходности.",
                investmentTerm: "Срок Инвестиций",
                investmentTermHint: "Продолжительность вашего вложения. Более длительные сроки обычно приводят к более высокой доходности благодаря капитализации.",
                additionalInvestment: "Дополнительные Вложения",
                additionalInvestmentHint: "Регулярные дополнительные вложения могут значительно увеличить вашу конечную сумму благодаря усреднению стоимости.",
                targetMonthlyIncome: "Целевой Месячный Доход (X)",
                targetMonthlyIncomeHint: "Месячный доход, который вы хотите получить от инвестиций. Это помогает планировать финансовые цели.",
                calculatedResults: "Вычисляемые Параметры",
                finalAmount: "Конечная Сумма",
                finalAmountHint: "Общая сумма в конце периода инвестиций, включая всю прибыль",
                totalProfit: "Полный Доход",
                totalProfitHint: "Абсолютная прибыль и процентный доход за весь период",
                effectiveRate: "Эффективная Ставка",
                effectiveRateHint: "Фактическая годовая доходность с учетом эффекта капитализации",
                theoreticalMonthlyIncome: "Теоретический Месячный Доход",
                theoreticalMonthlyIncomeHint: "Месячный доход при снятии процентов с финальной суммы",
                averageMonthlyProfit: "Средний Месячный Прирост",
                averageMonthlyProfitHint: "Среднемесячный рост капитала за период инвестиций",
                averageAnnualProfit: "Средний Годовой Прирост",
                averageAnnualProfitHint: "Среднегодовой рост капитала за период инвестиций",
                keyMilestones: "Ключевые Вехи",
                doubleInvestment: "Удвоение Вклада",
                tenfoldInvestment: "Удесятерение Вклада",
                hundredfoldInvestment: "Увеличение в 100 раз",
                targetMonthlyIncomeMilestone: "Целевой Месячный Доход",
                monthlyIncomePlan: "Помесячный План Дохода",
                month: "Месяц",
                cumulativeAmount: "Накопленная Сумма",
                monthlyIncome: "Месячный Доход",
                monthlyPercentage: "% от Начальной",
                noCompounding: "Без Капитализации",
                daily: "Ежедневно",
                monthly: "Ежемесячно",
                quarterly: "Ежеквартально",
                semiAnnually: "Полугодовой",
                annually: "Ежегодно",
                days: "Дни",
                months: "Месяцы",
                years: "Годы",
                noAdditional: "Без Дополнительных",
                double: "Удвоение",
                tenfold: "Удесятерение",
                hundredfold: "Увеличение в 100 раз"
            }
        };

        let currentLanguage = 'en';

        // DOM Elements
        const elements = {
            languageToggle: document.getElementById('languageToggle'),
            initialAmount: document.getElementById('initialAmount'),
            interestRate: document.getElementById('interestRate'),
            compounding: document.getElementById('compounding'),
            investmentTerm: document.getElementById('investmentTerm'),
            termUnit: document.getElementById('termUnit'),
            additionalAmount: document.getElementById('additionalAmount'),
            additionalFrequency: document.getElementById('additionalFrequency'),
            targetMonthlyIncome: document.getElementById('targetMonthlyIncome'),
            finalAmountValue: document.getElementById('finalAmountValue'),
            totalProfitValue: document.getElementById('totalProfitValue'),
            effectiveRateValue: document.getElementById('effectiveRateValue'),
            theoreticalMonthlyIncomeValue: document.getElementById('theoreticalMonthlyIncomeValue'),
            averageMonthlyProfitValue: document.getElementById('averageMonthlyProfitValue'),
            averageAnnualProfitValue: document.getElementById('averageAnnualProfitValue'),
            doubleValue: document.getElementById('doubleValue'),
            tenfoldValue: document.getElementById('tenfoldValue'),
            hundredfoldValue: document.getElementById('hundredfoldValue'),
            targetIncomeValue: document.getElementById('targetIncomeValue'),
            planTableBody: document.getElementById('planTableBody')
        };

        // Translation elements mapping
        const translationElements = {
            title: document.querySelector('h1'),
            inputParameters: document.querySelector('.input-section .section-title'),
            initialAmountLabel: document.getElementById('initialAmountLabel'),
            initialAmountHint: document.getElementById('initialAmountHint'),
            interestRateLabel: document.getElementById('interestRateLabel'),
            interestRateHint: document.getElementById('interestRateHint'),
            compoundingLabel: document.getElementById('compoundingLabel'),
            compoundingHint: document.getElementById('compoundingHint'),
            investmentTermLabel: document.getElementById('investmentTermLabel'),
            investmentTermHint: document.getElementById('investmentTermHint'),
            additionalInvestmentLabel: document.getElementById('additionalInvestmentLabel'),
            additionalInvestmentHint: document.getElementById('additionalInvestmentHint'),
            targetMonthlyIncomeLabel: document.getElementById('targetMonthlyIncomeLabel'),
            targetMonthlyIncomeHint: document.getElementById('targetMonthlyIncomeHint'),
            calculatedResults: document.querySelector('.results-section .section-title'),
            finalAmountLabel: document.querySelector('[id="finalAmountLabel"]'),
            finalAmountHint: document.querySelector('[id="finalAmountHint"]'),
            totalProfitLabel: document.querySelector('[id="totalProfitLabel"]'),
            totalProfitHint: document.querySelector('[id="totalProfitHint"]'),
            effectiveRateLabel: document.querySelector('[id="effectiveRateLabel"]'),
            effectiveRateHint: document.querySelector('[id="effectiveRateHint"]'),
            theoreticalMonthlyIncomeLabel: document.querySelector('[id="theoreticalMonthlyIncomeLabel"]'),
            theoreticalMonthlyIncomeHint: document.querySelector('[id="theoreticalMonthlyIncomeHint"]'),
            averageMonthlyProfitLabel: document.querySelector('[id="averageMonthlyProfitLabel"]'),
            averageMonthlyProfitHint: document.querySelector('[id="averageMonthlyProfitHint"]'),
            averageAnnualProfitLabel: document.querySelector('[id="averageAnnualProfitLabel"]'),
            averageAnnualProfitHint: document.querySelector('[id="averageAnnualProfitHint"]'),
            keyMilestones: document.querySelector('.milestones-section .section-title'),
            doubleLabel: document.getElementById('doubleLabel'),
            tenfoldLabel: document.getElementById('tenfoldLabel'),
            hundredfoldLabel: document.getElementById('hundredfoldLabel'),
            targetIncomeLabel: document.getElementById('targetIncomeLabel'),
            monthlyIncomePlan: document.querySelector('.plan-section .section-title'),
            monthLabel: document.getElementById('monthLabel'),
            cumulativeAmountLabel: document.getElementById('cumulativeAmountLabel'),
            monthlyIncomeLabel: document.getElementById('monthlyIncomeLabel'),
            monthlyPercentageLabel: document.getElementById('monthlyPercentageLabel')
        };

        // Initialize compounding options
        function initializeCompoundingOptions() {
            const compoundingOptions = {
                en: [
                    { value: "0", text: "No Compounding" },
                    { value: "1", text: "Daily" },
                    { value: "30", text: "Monthly" },
                    { value: "90", text: "Quarterly" },
                    { value: "180", text: "Semi-Annually" },
                    { value: "365", text: "Annually" }
                ],
                ru: [
                    { value: "0", text: "Без Капитализации" },
                    { value: "1", text: "Ежедневно" },
                    { value: "30", text: "Ежемесячно" },
                    { value: "90", text: "Ежеквартально" },
                    { value: "180", text: "Полугодовой" },
                    { value: "365", text: "Ежегодно" }
                ]
            };

            const termUnitOptions = {
                en: [
                    { value: "1", text: "Days" },
                    { value: "30", text: "Months" },
                    { value: "365", text: "Years" }
                ],
                ru: [
                    { value: "1", text: "Дни" },
                    { value: "30", text: "Месяцы" },
                    { value: "365", text: "Годы" }
                ]
            };

            const additionalFrequencyOptions = {
                en: [
                    { value: "0", text: "No Additional" },
                    { value: "1", text: "Daily" },
                    { value: "30", text: "Monthly" },
                    { value: "90", text: "Quarterly" },
                    { value: "365", text: "Annually" }
                ],
                ru: [
                    { value: "0", text: "Без Дополнительных" },
                    { value: "1", text: "Ежедневно" },
                    { value: "30", text: "Ежемесячно" },
                    { value: "90", text: "Ежеквартально" },
                    { value: "365", text: "Ежегодно" }
                ]
            };

            // Clear and populate compounding options
            elements.compounding.innerHTML = '';
            compoundingOptions[currentLanguage].forEach(option => {
                const opt = document.createElement('option');
                opt.value = option.value;
                opt.textContent = option.text;
                if (option.value === "365") opt.selected = true;
                elements.compounding.appendChild(opt);
            });

            // Clear and populate term unit options
            elements.termUnit.innerHTML = '';
            termUnitOptions[currentLanguage].forEach(option => {
                const opt = document.createElement('option');
                opt.value = option.value;
                opt.textContent = option.text;
                if (option.value === "365") opt.selected = true;
                elements.termUnit.appendChild(opt);
            });

            // Clear and populate additional frequency options
            elements.additionalFrequency.innerHTML = '';
            additionalFrequencyOptions[currentLanguage].forEach(option => {
                const opt = document.createElement('option');
                opt.value = option.value;
                opt.textContent = option.text;
                if (option.value === "30") opt.selected = true;
                elements.additionalFrequency.appendChild(opt);
            });
        }

        // Format number with commas
        function formatNumber(num) {
            return Math.abs(num) > 999999 
                ? (num / 1000000).toFixed(2) + 'M' 
                : Math.abs(num) > 999 
                ? (num / 1000).toFixed(1) + 'K' 
                : num.toFixed(2);
        }

        // Format time period
        function formatTimePeriod(days) {
            const years = Math.floor(days / 365);
            const remainingDays = days % 365;
            const months = Math.floor(remainingDays / 30);
            const finalDays = remainingDays % 30;

            let result = '';
            if (years > 0) {
                result += years + (currentLanguage === 'en' ? ' years ' : ' лет ');
            }
            if (months > 0) {
                result += months + (currentLanguage === 'en' ? ' months ' : ' месяцев ');
            }
            if (finalDays > 0 || result === '') {
                result += finalDays + (currentLanguage === 'en' ? ' days' : ' дней');
            }
            return result.trim();
        }

        // Calculate compound interest with correct compounding logic
        function calculateCompoundInterest(principal, rate, compoundingDays, termDays, additionalAmount, additionalFrequency) {
            const annualRate = rate / 100;
            
            // No compounding - simple interest
            if (compoundingDays === 0) {
                const simpleInterest = principal * annualRate * (termDays / 365);
                let amount = principal + simpleInterest;
                
                // Add additional investments
                if (additionalFrequency > 0 && additionalAmount > 0) {
                    const numberOfAdditionalInvestments = Math.floor(termDays / additionalFrequency);
                    amount += additionalAmount * numberOfAdditionalInvestments;
                }
                
                return amount;
            }
            
            // With compounding
            let amount = principal;
            const dailyRate = annualRate / 365;
            
            for (let day = 1; day <= termDays; day++) {
                // Add additional investment if applicable
                if (additionalFrequency > 0 && day % additionalFrequency === 0) {
                    amount += additionalAmount;
                }
                
                // Apply compounding
                if (day % compoundingDays === 0) {
                    const periodRate = dailyRate * compoundingDays;
                    amount *= (1 + periodRate);
                }
            }
            
            return amount;
        }

        // Calculate monthly plan
        function calculateMonthlyPlan(principal, rate, compoundingDays, termDays, additionalAmount, additionalFrequency) {
            const annualRate = rate / 100;
            const dailyRate = annualRate / 365;
            let amount = principal;
            const monthlyData = [];
            let previousMonthAmount = principal;

            for (let month = 1; month <= Math.ceil(termDays / 30); month++) {
                const daysInMonth = Math.min(30, termDays - (month - 1) * 30);
                
                for (let day = 1; day <= daysInMonth; day++) {
                    const dayIndex = (month - 1) * 30 + day;
                    if (dayIndex > termDays) break;

                    // Add additional investment if applicable
                    if (additionalFrequency > 0 && dayIndex % additionalFrequency === 0) {
                        amount += additionalAmount;
                    }

                    // Apply compounding
                    if (compoundingDays > 0 && dayIndex % compoundingDays === 0) {
                        const periodRate = dailyRate * compoundingDays;
                        amount *= (1 + periodRate);
                    }
                }

                const monthlyIncome = amount - previousMonthAmount;
                monthlyData.push({
                    month: month,
                    cumulativeAmount: amount,
                    monthlyIncome: monthlyIncome,
                    percentageOfInitial: principal > 0 ? (monthlyIncome / principal) * 100 : 0
                });

                previousMonthAmount = amount;
            }

            return monthlyData;
        }

        // Calculate effective annual rate correctly - average effective rate over the entire investment term
        function calculateEffectiveRate(principal, finalAmount, termDays, compoundingDays, nominalRate) {
            if (termDays <= 0 || principal <= 0) return 0;
            
            // For no compounding, effective rate equals nominal rate
            if (compoundingDays === 0) {
                return nominalRate;
            }
            
            // Calculate the actual growth factor over the entire term
            const totalGrowthFactor = finalAmount / principal;
            
            // Calculate the effective annual rate that would produce this growth over the term
            // This is the CAGR (Compound Annual Growth Rate) formula
            // (1 + EAR)^(termDays/365) = totalGrowthFactor
            // EAR = totalGrowthFactor^(365/termDays) - 1
            const effectiveRate = (Math.pow(totalGrowthFactor, 365 / termDays) - 1) * 100;
            
            return effectiveRate;
        }

        // Calculate average monthly and annual profits
        function calculateAverageProfits(principal, finalAmount, termDays) {
            if (termDays <= 0 || principal <= 0) return { monthly: 0, annual: 0, monthlyPercent: 0, annualPercent: 0 };
            
            const totalProfit = finalAmount - principal;
            
            // Average monthly profit in amount
            const months = termDays / 30;
            const averageMonthlyProfit = months > 0 ? totalProfit / months : 0;
            
            // Average annual profit in amount
            const years = termDays / 365;
            const averageAnnualProfit = years > 0 ? totalProfit / years : 0;
            
            // Average monthly profit in percentage
            const averageMonthlyPercent = months > 0 ? (totalProfit / principal) * 100 / months : 0;
            
            // Average annual profit in percentage
            const averageAnnualPercent = years > 0 ? (totalProfit / principal) * 100 / years : 0;
            
            return {
                monthly: averageMonthlyProfit,
                annual: averageAnnualProfit,
                monthlyPercent: averageMonthlyPercent,
                annualPercent: averageAnnualPercent
            };
        }

        // Calculate milestones
        function calculateMilestones(principal, rate, compoundingDays, additionalAmount, additionalFrequency, targetIncome) {
            const annualRate = rate / 100;
            const dailyRate = annualRate / 365;
            let amount = principal;
            let daysToDouble = 0;
            let daysToTenfold = 0;
            let daysToHundredfold = 0;
            let daysToTargetIncome = 0;

            // Find doubling time
            amount = principal;
            for (let day = 1; day <= 365 * 100; day++) {
                // Add additional investment if applicable
                if (additionalFrequency > 0 && day % additionalFrequency === 0) {
                    amount += additionalAmount;
                }

                // Apply compounding
                if (compoundingDays > 0 && day % compoundingDays === 0) {
                    const periodRate = dailyRate * compoundingDays;
                    amount *= (1 + periodRate);
                } else if (compoundingDays === 0) {
                    // Simple interest for no compounding
                    amount += principal * dailyRate;
                }

                if (daysToDouble === 0 && amount >= principal * 2) {
                    daysToDouble = day;
                }
                if (daysToTenfold === 0 && amount >= principal * 10) {
                    daysToTenfold = day;
                }
                if (daysToHundredfold === 0 && amount >= principal * 100) {
                    daysToHundredfold = day;
                }
                if (daysToTargetIncome === 0 && (amount * annualRate / 12) >= targetIncome) {
                    daysToTargetIncome = day;
                }

                if (daysToDouble > 0 && daysToTenfold > 0 && daysToHundredfold > 0 && daysToTargetIncome > 0) {
                    break;
                }
            }

            return {
                double: daysToDouble,
                tenfold: daysToTenfold,
                hundredfold: daysToHundredfold,
                targetIncome: daysToTargetIncome
            };
        }

        // Update calculations
        function updateCalculations() {
            const principal = parseFloat(elements.initialAmount.value) || 0;
            const rate = parseFloat(elements.interestRate.value) || 0;
            const compoundingDays = parseInt(elements.compounding.value) || 0;
            const termValue = parseFloat(elements.investmentTerm.value) || 0;
            const termUnit = parseInt(elements.termUnit.value) || 365;
            const termDays = termValue * termUnit;
            const additionalAmount = parseFloat(elements.additionalAmount.value) || 0;
            const additionalFrequency = parseInt(elements.additionalFrequency.value) || 0;
            const targetIncome = parseFloat(elements.targetMonthlyIncome.value) || 0;

            // Calculate final amount
            const finalAmount = calculateCompoundInterest(principal, rate, compoundingDays, termDays, additionalAmount, additionalFrequency);
            const totalProfit = finalAmount - principal;
            const totalProfitPercentage = principal > 0 ? (totalProfit / principal) * 100 : 0;

            // Calculate effective rate
            const effectiveRate = calculateEffectiveRate(principal, finalAmount, termDays, compoundingDays, rate);

            // Calculate theoretical monthly income (from final amount)
            const theoreticalMonthlyIncome = termDays > 0 ? (finalAmount * (rate / 100) / 12) : 0;

            // Calculate average profits
            const averageProfits = calculateAverageProfits(principal, finalAmount, termDays);

            // Update results
            elements.finalAmountValue.textContent = formatNumber(finalAmount);
            elements.totalProfitValue.textContent = formatNumber(totalProfit) + ` (${totalProfitPercentage.toFixed(1)}%)`;
            elements.effectiveRateValue.textContent = effectiveRate.toFixed(2) + '%';
            elements.theoreticalMonthlyIncomeValue.textContent = formatNumber(theoreticalMonthlyIncome);
            elements.averageMonthlyProfitValue.textContent = formatNumber(averageProfits.monthly) + ` (${averageProfits.monthlyPercent.toFixed(2)}%)`;
            elements.averageAnnualProfitValue.textContent = formatNumber(averageProfits.annual) + ` (${averageProfits.annualPercent.toFixed(2)}%)`;

            // Calculate milestones
            const milestones = calculateMilestones(principal, rate, compoundingDays, additionalAmount, additionalFrequency, targetIncome);
            elements.doubleValue.textContent = milestones.double > 0 ? formatTimePeriod(milestones.double) : (currentLanguage === 'en' ? 'Never' : 'Никогда');
            elements.tenfoldValue.textContent = milestones.tenfold > 0 ? formatTimePeriod(milestones.tenfold) : (currentLanguage === 'en' ? 'Never' : 'Никогда');
            elements.hundredfoldValue.textContent = milestones.hundredfold > 0 ? formatTimePeriod(milestones.hundredfold) : (currentLanguage === 'en' ? 'Never' : 'Никогда');
            elements.targetIncomeValue.textContent = milestones.targetIncome > 0 ? formatTimePeriod(milestones.targetIncome) : (currentLanguage === 'en' ? 'Never' : 'Никогда');

            // Calculate monthly plan
            const monthlyPlan = calculateMonthlyPlan(principal, rate, compoundingDays, termDays, additionalAmount, additionalFrequency);
            updateMonthlyPlanTable(monthlyPlan, principal);
        }

        // Update monthly plan table
        function updateMonthlyPlanTable(monthlyData, principal) {
            elements.planTableBody.innerHTML = '';
            
            monthlyData.forEach(data => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${data.month}</td>
                    <td class="cumulative">${formatNumber(data.cumulativeAmount)}</td>
                    <td class="${data.monthlyIncome >= 0 ? 'positive' : 'negative'}">${formatNumber(data.monthlyIncome)}</td>
                    <td>${data.percentageOfInitial.toFixed(2)}%</td>
                `;
                elements.planTableBody.appendChild(row);
            });
        }

        // Translate UI
        function translateUI() {
            const t = translations[currentLanguage];
            
            // Update text content
            translationElements.title.textContent = t.title;
            translationElements.inputParameters.textContent = t.inputParameters;
            translationElements.initialAmountLabel.textContent = t.initialAmount;
            translationElements.initialAmountHint.textContent = t.initialAmountHint;
            translationElements.interestRateLabel.textContent = t.interestRate;
            translationElements.interestRateHint.textContent = t.interestRateHint;
            translationElements.compoundingLabel.textContent = t.compounding;
            translationElements.compoundingHint.textContent = t.compoundingHint;
            translationElements.investmentTermLabel.textContent = t.investmentTerm;
            translationElements.investmentTermHint.textContent = t.investmentTermHint;
            translationElements.additionalInvestmentLabel.textContent = t.additionalInvestment;
            translationElements.additionalInvestmentHint.textContent = t.additionalInvestmentHint;
            translationElements.targetMonthlyIncomeLabel.textContent = t.targetMonthlyIncome;
            translationElements.targetMonthlyIncomeHint.textContent = t.targetMonthlyIncomeHint;
            translationElements.calculatedResults.textContent = t.calculatedResults;
            translationElements.finalAmountLabel.textContent = t.finalAmount;
            translationElements.finalAmountHint.textContent = t.finalAmountHint;
            translationElements.totalProfitLabel.textContent = t.totalProfit;
            translationElements.totalProfitHint.textContent = t.totalProfitHint;
            translationElements.effectiveRateLabel.textContent = t.effectiveRate;
            translationElements.effectiveRateHint.textContent = t.effectiveRateHint;
            translationElements.theoreticalMonthlyIncomeLabel.textContent = t.theoreticalMonthlyIncome;
            translationElements.theoreticalMonthlyIncomeHint.textContent = t.theoreticalMonthlyIncomeHint;
            translationElements.averageMonthlyProfitLabel.textContent = t.averageMonthlyProfit;
            translationElements.averageMonthlyProfitHint.textContent = t.averageMonthlyProfitHint;
            translationElements.averageAnnualProfitLabel.textContent = t.averageAnnualProfit;
            translationElements.averageAnnualProfitHint.textContent = t.averageAnnualProfitHint;
            translationElements.keyMilestones.textContent = t.keyMilestones;
            translationElements.doubleLabel.textContent = t.doubleInvestment;
            translationElements.tenfoldLabel.textContent = t.tenfoldInvestment;
            translationElements.hundredfoldLabel.textContent = t.hundredfoldInvestment;
            translationElements.targetIncomeLabel.textContent = t.targetMonthlyIncomeMilestone;
            translationElements.monthlyIncomePlan.textContent = t.monthlyIncomePlan;
            translationElements.monthLabel.textContent = t.month;
            translationElements.cumulativeAmountLabel.textContent = t.cumulativeAmount;
            translationElements.monthlyIncomeLabel.textContent = t.monthlyIncome;
            translationElements.monthlyPercentageLabel.textContent = t.monthlyPercentage;

            // Update button text
            elements.languageToggle.textContent = currentLanguage === 'en' ? 'RU' : 'EN';

            // Reinitialize options
            initializeCompoundingOptions();
        }

        // Event listeners
        elements.languageToggle.addEventListener('click', () => {
            currentLanguage = currentLanguage === 'en' ? 'ru' : 'en';
            translateUI();
            updateCalculations();
        });

        // Add event listeners to all input fields
        Object.values(elements).forEach(element => {
            if (element && element.addEventListener) {
                element.addEventListener('input', updateCalculations);
            }
        });

        // Initialize
        initializeCompoundingOptions();
        updateCalculations();
    </script>
</body>
</html>