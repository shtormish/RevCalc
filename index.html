<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Fix for icons on GitHub Pages: Set Content Security Policy to allow images from shields.io -->
    <meta http-equiv="Content-Security-Policy" content="img-src 'self' data: https://img.shields.io;">
    <!-- Add a simple emoji-based favicon -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ“ˆ</text></svg>">
    <title>Investment Calculator</title>
    <style>
        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --secondary: #f8fafc;
            --text: #0f172a;
            --text-secondary: #64748b;
            --border: #e2e8f0;
            --grid-line-color: #cbd5e1;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --milestone-double: #34d399;
            --milestone-tenfold: #fbbf24;
            --milestone-hundredfold: #ef4444;
            --milestone-target: #60a5fa;
            --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            color: var(--text);
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 6px;
            padding: 15px 20px;
            background: white;
            border-radius: 16px;
            box-shadow: var(--shadow);
        }

        .header__title {
            font-size: 1.75rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .header__actions {
            display: flex;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
            justify-content: flex-end;
        }

        .header__badges {
            display: flex;
            gap: 10px;
        }

        .header__button {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s ease;
            box-shadow: var(--shadow);
        }

        .header__button:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
        }

        .calculator {
            display: grid;
            grid-template-columns: 1fr;
            gap: 6px;
            margin-bottom: 6px;
        }

        .input-section, .results-section {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: var(--shadow);
        }

        .section__title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 6px;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .input-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px 20px;
        }

        .input-group { /* This can remain as a block itself */
            margin-bottom: 0;
        }

        .input-group__label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            font-size: 0.95rem;
        }

        .input-group__hint {
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-top: 4px;
            line-height: 1.4;
        }

        .input-group__field {
            width: 100%;
            padding: 10px 14px;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-size: 1rem;
            transition: all 0.2s ease;
            background: var(--secondary);
        }

        .input-group__field:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .input-group__row {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 15px;
        }

        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
        }

        .result-card {
            background: var(--secondary);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            transition: transform 0.2s ease;
            min-height: 100px;
        }

        .result-card:hover {
            transform: translateY(-2px);
        }

        .result-card__value {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary);
            margin: 8px 0;
        }

        .result-card__label {
            font-size: 0.85rem;
            color: var(--text-secondary);
            line-height: 1.3;
        }

        .result-card__hint {
            font-size: 0.7rem;
            color: var(--text-secondary);
            margin-top: 4px;
            line-height: 1.2;
        }

        .milestones-section {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 6px;
            box-shadow: var(--shadow);
        }

        .milestones-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .milestone-card {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border-radius: 12px;
            padding: 20px;
            border-left: 4px solid transparent;
        }

        .milestone-card--double { border-left-color: var(--milestone-double); }
        .milestone-card--double .milestone-card__title { color: var(--milestone-double); }

        .milestone-card--tenfold { border-left-color: var(--milestone-tenfold); }
        .milestone-card--tenfold .milestone-card__title { color: var(--milestone-tenfold); }

        .milestone-card--hundredfold { border-left-color: var(--milestone-hundredfold); }
        .milestone-card--hundredfold .milestone-card__title { color: var(--milestone-hundredfold); }

        .milestone-card--target { border-left-color: var(--milestone-target); }
        .milestone-card--target .milestone-card__title { color: var(--milestone-target); }

        .milestone-card__title {
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--primary);
        }

        .milestone-card__value {
            font-size: 1.2rem;
            font-weight: 700;
        }
        
        .chart-section {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: var(--shadow);
            margin-bottom: 6px;
        }

        .chart-container {
            position: relative;
            width: 100%;
            height: 300px;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .chart-container svg {
            width: 100%;
            height: 100%;
        }

        .chart-line {
            fill: none;
            stroke: var(--primary);
            stroke-width: 3;
            stroke-linecap: round;
            stroke-linejoin: round;
        }

        .chart-fill {
            fill: url(#chartGradient);
            stroke: none;
        }

        .grid-line, .axis-line {
            stroke: var(--grid-line-color);
            stroke-dasharray: 2, 3;
        }

        .axis-label {
            font-size: 0.75rem;
            fill: var(--text-secondary);
        }

        .milestone-line {
            stroke-width: 1.5;
            stroke-dasharray: 4, 4;
            pointer-events: none;
        }

        .milestone-label {
            font-size: 0.7rem;
            font-weight: 600;
            text-anchor: middle;
            pointer-events: none;
        }

        .chart-tooltip {
            position: absolute;
            display: none;
            padding: 8px 12px;
            background: var(--text);
            color: white;
            border-radius: 8px;
            font-size: 0.85rem;
            pointer-events: none; /* So it doesn't interfere with mouse events */
            transform: translate(-50%, -120%); /* Position above cursor */
            transition: opacity 0.1s ease;
            white-space: nowrap;
            z-index: 10;
        }

        .chart-indicator-line {
            stroke: var(--primary);
            stroke-width: 1;
            stroke-dasharray: 3, 3;
            pointer-events: none;
        }

        .chart-indicator-point {
            fill: var(--primary);
            stroke: white;
            stroke-width: 2px;
            pointer-events: none;
        }

        .plan-section {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: var(--shadow);
        }

        .plan-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .plan-table__header {
            background: var(--secondary);
            padding: 12px 16px;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid var(--border);
        }

        .plan-table__cell {
            padding: 12px 16px;
            border-bottom: 1px solid var(--border);
        }

        .plan-table__row:hover {
            background: var(--secondary);
        }

        .plan-table__cell--cumulative {
            font-weight: 600;
        }

        .plan-table__cell--positive {
            color: var(--success);
        }

        .plan-table__cell--negative {
            color: var(--danger);
        }

        /* Responsive design */
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }

            .input-group__row {
                grid-template-columns: 1fr;
            }

            .input-grid {
                grid-template-columns: 1fr;
                gap: 0;
            }

            .input-group {
                margin-bottom: 15px;
            }

            .results-grid {
                grid-template-columns: 1fr 1fr;
                gap: 10px;
            }

            .milestones-grid {
                grid-template-columns: 1fr;
            }
            
            .result-card {
                padding: 12px;
                min-height: 90px;
            }
            
            .result-value {
                font-size: 1.1rem;
                margin: 6px 0;
            }
        }

        @media (max-width: 480px) {
            .results-grid {
                grid-template-columns: 1fr;
                gap: 8px;
            }

            body {
                padding: 10px;
            }

            .input-section, .results-section, .milestones-section, .plan-section {
                padding: 20px 15px;
            }
            
            .result-card {
                padding: 10px;
                min-height: 80px;
            }
            
            .result-value {
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1 class="header__title" id="title">Investment Calculator</h1>
            <div class="header__actions">
                <div class="header__badges">
                    <a href="https://github.com/shtormish/RevCalc/" target="_blank" rel="noopener noreferrer">
                        <img src="https://img.shields.io/github/stars/shtormish/RevCalc?style=social" alt="GitHub Stars">
                    </a>
                    <a href="https://github.com/shtormish/RevCalc/blob/main/LICENSE" target="_blank" rel="noopener noreferrer">
                        <img src="https://img.shields.io/badge/License-MIT-blue" alt="License: MIT">
                    </a>
                </div>
                <button class="header__button" id="languageToggle">RU</button>
            </div>
        </div>

        <div class="calculator">
            <div class="input-section">
                <h2 class="section__title">Input Parameters</h2>
                <div class="input-grid">
                    <div class="input-group">
                        <label class="input-group__label" id="initialAmountLabel">Initial Investment Amount</label>
                        <input type="number" class="input-group__field" id="initialAmount" value="10000" min="0">
                        <div class="input-group__hint" id="initialAmountHint">The starting amount of your investment. This is the base amount that will earn interest over time.</div>
                    </div>

                    <div class="input-group">
                        <label class="input-group__label" id="interestRateLabel">Annual Interest Rate (%)</label>
                        <input type="number" class="input-group__field" id="interestRate" value="8" min="0" max="100" step="0.1">
                        <div class="input-group__hint" id="interestRateHint">The annual percentage rate at which your investment will grow. Higher rates mean faster growth.</div>
                    </div>

                    <div class="input-group">
                        <label class="input-group__label" id="compoundingLabel">Compounding Period</label>
                        <select class="input-group__field" id="compounding">
                            <option value="0">No Compounding</option>
                            <option value="1">Daily</option>
                            <option value="30">Monthly</option>
                            <option value="90">Quarterly</option>
                            <option value="180">Semi-Annually</option>
                            <option value="365" selected>Annually</option>
                        </select>
                        <div class="input-group__hint" id="compoundingHint">How often interest is added to your principal. More frequent compounding leads to higher returns.</div>
                    </div>

                    <div class="input-group">
                        <label class="input-group__label" id="investmentTermLabel">Investment Term</label>
                        <div class="input-group__row">
                            <input type="number" class="input-group__field" id="investmentTerm" value="10" min="0">
                            <select class="input-group__field" id="termUnit">
                                <option value="1">Days</option>
                                <option value="30">Months</option>
                                <option value="365" selected>Years</option>
                            </select>
                        </div>
                        <div class="input-group__hint" id="investmentTermHint">The duration of your investment. Longer terms generally lead to higher returns due to compounding.</div>
                    </div>

                    <div class="input-group">
                        <label class="input-group__label" id="additionalInvestmentLabel">Additional Investment</label>
                        <div class="input-group__row">
                            <input type="number" class="input-group__field" id="additionalAmount" value="0" min="0">
                            <select class="input-group__field" id="additionalFrequency">
                                <option value="0">No Additional</option>
                                <option value="1">Daily</option>
                                <option value="30" selected>Monthly</option>
                                <option value="90">Quarterly</option>
                                <option value="365">Annually</option>
                            </select>
                        </div>
                        <div class="input-group__hint" id="additionalInvestmentHint">Regular additional investments can significantly boost your final amount through dollar-cost averaging.</div>
                    </div>

                    <div class="input-group">
                        <label class="input-group__label" id="targetMonthlyIncomeLabel">Target Monthly Income (X)</label>
                        <input type="number" class="input-group__field" id="targetMonthlyIncome" value="1000" min="0">
                        <div class="input-group__hint" id="targetMonthlyIncomeHint">The monthly income you want to achieve from your investment. This helps plan for financial goals.</div>
                    </div>
                </div>
            </div>

            <div class="results-section">
                <h2 class="section__title">Calculated Results</h2>
                <div class="results-grid">
                    <div class="result-card">
                        <div class="result-card__label" id="finalAmountLabel">Final Amount</div>
                        <div class="result-card__value" id="finalAmountValue">0</div>
                        <div class="result-card__hint" id="finalAmountHint">Total amount at the end of investment period including all profits</div>
                    </div>
                    <div class="result-card">
                        <div class="result-card__label" id="totalProfitLabel">Total Profit</div>
                        <div class="result-card__value" id="totalProfitValue">0</div>
                        <div class="result-card__hint" id="totalProfitHint">Absolute profit and percentage gain over the entire period</div>
                    </div>
                    <div class="result-card">
                        <div class="result-card__label" id="effectiveRateLabel">Effective Rate</div>
                        <div class="result-card__value" id="effectiveRateValue">0%</div>
                        <div class="result-card__hint" id="effectiveRateHint">Actual annualized return considering compounding effect</div>
                    </div>
                    <div class="result-card">
                        <div class="result-card__label" id="theoreticalMonthlyIncomeLabel">Theoretical Monthly Income</div>
                        <div class="result-card__value" id="theoreticalMonthlyIncomeValue">0</div>
                        <div class="result-card__hint" id="theoreticalMonthlyIncomeHint">Monthly income if withdrawing interest from final amount</div>
                    </div>
                    <div class="result-card">
                        <div class="result-card__label" id="averageMonthlyProfitLabel">Avg Monthly Profit</div>
                        <div class="result-card__value" id="averageMonthlyProfitValue">0</div>
                        <div class="result-card__hint" id="averageMonthlyProfitHint">Average monthly capital growth during investment period</div>
                    </div>
                    <div class="result-card">
                        <div class="result-card__label" id="averageAnnualProfitLabel">Avg Annual Profit</div>
                        <div class="result-card__value" id="averageAnnualProfitValue">0</div>
                        <div class="result-card__hint" id="averageAnnualProfitHint">Average annual capital growth during investment period</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="milestones-section">
            <h2 class="section__title">Key Milestones</h2>
            <div class="milestones-grid">
                <div class="milestone-card milestone-card--double">
                    <div class="milestone-card__title" id="doubleLabel">Double Investment</div>
                    <div class="milestone-card__value" id="doubleValue">0 years</div>
                </div>
                <div class="milestone-card milestone-card--tenfold">
                    <div class="milestone-card__title" id="tenfoldLabel">Tenfold Investment</div>
                    <div class="milestone-card__value" id="tenfoldValue">0 years</div>
                </div>
                <div class="milestone-card milestone-card--hundredfold">
                    <div class="milestone-card__title" id="hundredfoldLabel">Hundredfold Investment</div>
                    <div class="milestone-card__value" id="hundredfoldValue">0 years</div>
                </div>
                <div class="milestone-card milestone-card--target">
                    <div class="milestone-card__title" id="targetIncomeLabel">Target Monthly Income</div>
                    <div class="milestone-card__value" id="targetIncomeValue">0 years</div>
                </div>
            </div>
        </div>

        <div class="chart-section">
            <h2 class="section__title" id="chartTitle">Investment Growth Chart</h2>
            <div class="chart-container" id="chartContainer">
                <!-- SVG chart is injected here by JavaScript -->
            </div>
        </div>

        <div class="plan-section">
            <h2 class="section__title">Monthly Income Plan</h2>
            <div>
                <table class="plan-table">
                    <thead>
                        <tr class="plan-table__row">
                            <th class="plan-table__header" id="monthLabel">Month</th>
                            <th class="plan-table__header" id="cumulativeAmountLabel">Cumulative Amount</th>
                            <th class="plan-table__header" id="monthlyIncomeLabel">Monthly Income</th>
                            <th class="plan-table__header" id="monthlyPercentageLabel">% of Initial</th>
                        </tr>
                    </thead>
                    <tbody id="planTableBody">
                        <!-- Generated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // Format number with K/M suffixes for brevity.
        function formatNumber(num) {
            if (Math.abs(num) > 999999) {
                return (num / 1000000).toFixed(2) + 'M';
            }
            if (Math.abs(num) > 999) {
                return (num / 1000).toFixed(1) + 'K';
            }
            return num.toFixed(2);
        }

        // Format a period of days into a human-readable string (e.g., "1 year 2 months 3 days").
        // This version includes improved pluralization for both English and Russian.
        function formatTimePeriod(days, lang = 'en') {
            if (!days || days <= 0) {
                return lang === 'en' ? 'Never' : 'ÐÐ¸ÐºÐ¾Ð³Ð´Ð°';
            }

            const years = Math.floor(days / 365);
            const months = Math.floor((days % 365) / 30);
            const remainingDays = Math.round(days - (years * 365) - (months * 30));

            const parts = [];

            if (lang === 'en') {
                if (years > 0) parts.push(`${years} ${years === 1 ? 'year' : 'years'}`);
                if (months > 0) parts.push(`${months} ${months === 1 ? 'month' : 'months'}`);
                if (remainingDays > 0) parts.push(`${remainingDays} ${remainingDays === 1 ? 'day' : 'days'}`);
            } else { // ru
                const pluralize = (count, forms) => { // [one, few, many] e.g. ['Ð³Ð¾Ð´', 'Ð³Ð¾Ð´Ð°', 'Ð»ÐµÑ‚']
                    const n = Math.abs(count) % 100;
                    const n1 = n % 10;
                    if (n > 10 && n < 20) return forms[2];
                    if (n1 > 1 && n1 < 5) return forms[1];
                    if (n1 === 1) return forms[0];
                    return forms[2];
                };
                if (years > 0) parts.push(`${years} ${pluralize(years, ['Ð³Ð¾Ð´', 'Ð³Ð¾Ð´Ð°', 'Ð»ÐµÑ‚'])}`);
                if (months > 0) parts.push(`${months} ${pluralize(months, ['Ð¼ÐµÑÑÑ†', 'Ð¼ÐµÑÑÑ†Ð°', 'Ð¼ÐµÑÑÑ†ÐµÐ²'])}`);
                if (remainingDays > 0) parts.push(`${remainingDays} ${pluralize(remainingDays, ['Ð´ÐµÐ½ÑŒ', 'Ð´Ð½Ñ', 'Ð´Ð½ÐµÐ¹'])}`);
            }

            return parts.length > 0 ? parts.join(' ') : (lang === 'en' ? '0 days' : '0 Ð´Ð½ÐµÐ¹');
        }

        // Calculate compound interest using a daily simulation model.
        function calculateCompoundInterest(principal, rate, compoundingDays, termDays, additionalAmount, additionalFrequency) {
            const annualRate = rate / 100;

            // No compounding - simple interest
            if (compoundingDays === 0) {
                const simpleInterest = principal * annualRate * (termDays / 365);
                let amount = principal + simpleInterest;

                if (additionalFrequency > 0 && additionalAmount > 0) {
                    const numberOfAdditionalInvestments = Math.floor(termDays / additionalFrequency);
                    amount += additionalAmount * numberOfAdditionalInvestments;
                }
                return amount;
            }

            // With compounding
            let amount = principal;
            const dailyRate = annualRate / 365;

            for (let day = 1; day <= termDays; day++) {
                if (additionalFrequency > 0 && day % additionalFrequency === 0) {
                    amount += additionalAmount;
                }
                if (day % compoundingDays === 0) {
                    const periodRate = dailyRate * compoundingDays;
                    amount *= (1 + periodRate);
                }
            }
            return amount;
        }

        // Calculate a month-by-month breakdown of the investment growth.
        function calculateMonthlyPlan(principal, rate, compoundingDays, termDays, additionalAmount, additionalFrequency) {
            const annualRate = rate / 100;
            const dailyRate = annualRate / 365;
            let amount = principal;
            const monthlyData = [];
            let previousMonthAmount = principal;

            for (let month = 1; month <= Math.ceil(termDays / 30); month++) {
                const startDay = (month - 1) * 30 + 1;
                const endDay = Math.min(month * 30, termDays);

                for (let day = startDay; day <= endDay; day++) {
                    if (additionalFrequency > 0 && day % additionalFrequency === 0) {
                        amount += additionalAmount;
                    }
                    if (compoundingDays > 0 && day % compoundingDays === 0) {
                        const periodRate = dailyRate * compoundingDays;
                        amount *= (1 + periodRate);
                    }
                }

                const monthlyIncome = amount - previousMonthAmount;
                monthlyData.push({
                    month: month,
                    cumulativeAmount: amount,
                    monthlyIncome: monthlyIncome,
                    percentageOfInitial: principal > 0 ? (monthlyIncome / principal) * 100 : 0
                });
                previousMonthAmount = amount;
            }
            return monthlyData;
        }

        // Calculate the effective annual rate (CAGR).
        function calculateEffectiveRate(principal, finalAmount, termDays) {
            if (termDays <= 0 || principal <= 0 || finalAmount <= principal) return 0;
            const totalGrowthFactor = finalAmount / principal;
            const effectiveRate = (Math.pow(totalGrowthFactor, 365 / termDays) - 1) * 100;
            return effectiveRate;
        }

        // Calculate average monthly and annual profits.
        function calculateAverageProfits(principal, finalAmount, termDays) {
            if (termDays <= 0) return { monthly: 0, annual: 0, monthlyPercent: 0, annualPercent: 0 };

            const totalProfit = finalAmount - principal;
            const years = termDays / 365;
            const months = years * 12;

            const averageMonthlyProfit = months > 0 ? totalProfit / months : 0;
            const averageAnnualProfit = years > 0 ? totalProfit / years : 0;
            const averageMonthlyPercent = principal > 0 && months > 0 ? (totalProfit / principal) * 100 / months : 0;
            const averageAnnualPercent = principal > 0 && years > 0 ? (totalProfit / principal) * 100 / years : 0;

            return {
                monthly: averageMonthlyProfit,
                annual: averageAnnualProfit,
                monthlyPercent: averageMonthlyPercent,
                annualPercent: averageAnnualPercent
            };
        }

        // Calculate key investment milestones.
        function calculateMilestones(principal, rate, compoundingDays, additionalAmount, additionalFrequency, targetIncome) {
            const annualRate = rate / 100;
            const dailyRate = annualRate / 365;
            let amount = principal;
            let daysToDouble = 0, daysToTenfold = 0, daysToHundredfold = 0, daysToTargetIncome = 0;

            // Limit search to 100 years to prevent infinite loops
            for (let day = 1; day <= 365 * 100; day++) {
                if (additionalFrequency > 0 && day % additionalFrequency === 0) amount += additionalAmount;

                if (compoundingDays > 0 && day % compoundingDays === 0) {
                    amount *= (1 + dailyRate * compoundingDays);
                } else if (compoundingDays === 0) {
                    amount += principal * dailyRate; // Simple interest
                }

                if (daysToDouble === 0 && principal > 0 && amount >= principal * 2) daysToDouble = day;
                if (daysToTenfold === 0 && principal > 0 && amount >= principal * 10) daysToTenfold = day;
                if (daysToHundredfold === 0 && principal > 0 && amount >= principal * 100) daysToHundredfold = day;
                if (daysToTargetIncome === 0 && targetIncome > 0 && (amount * annualRate / 12) >= targetIncome) daysToTargetIncome = day;

                if (daysToDouble && daysToTenfold && daysToHundredfold && (daysToTargetIncome || targetIncome <= 0)) break;
            }

            return { double: daysToDouble, tenfold: daysToTenfold, hundredfold: daysToHundredfold, targetIncome: daysToTargetIncome };
        }

        // Generate data points for the chart with a daily simulation model.
        function generateChartData(principal, rate, compoundingDays, termDays, additionalAmount, additionalFrequency) {
            if (termDays < 1) return [];

            const annualRate = rate / 100;
            const dailyRate = annualRate / 365;
            const dataPoints = [{ day: 0, amount: principal }];
            let amount = principal;

            // Use a step to keep the number of points reasonable for performance
            const maxPoints = 200;
            const step = Math.max(1, Math.floor(termDays / maxPoints));

            for (let day = 1; day <= termDays; day++) {
                if (additionalFrequency > 0 && day % additionalFrequency === 0) amount += additionalAmount;

                if (compoundingDays > 0 && day % compoundingDays === 0) {
                    amount *= (1 + dailyRate * compoundingDays);
                } else if (compoundingDays === 0) {
                    amount += principal * dailyRate; // Simple interest simulation
                }

                if (day % step === 0 || day === termDays) {
                    dataPoints.push({ day: day, amount: amount });
                }
            }
            return dataPoints;
        }

        // Translation dictionaries
        const translations = {
            en: {
                title: "Investment Calculator",
                inputParameters: "Input Parameters",
                initialAmount: "Initial Investment Amount",
                initialAmountHint: "The starting amount of your investment. This is the base amount that will earn interest over time.",
                interestRate: "Annual Interest Rate (%)",
                interestRateHint: "The annual percentage rate at which your investment will grow. Higher rates mean faster growth.",
                compounding: "Compounding Period",
                compoundingHint: "How often interest is added to your principal. More frequent compounding leads to higher returns.",
                investmentTerm: "Investment Term",
                investmentTermHint: "The duration of your investment. Longer terms generally lead to higher returns due to compounding.",
                additionalInvestment: "Additional Investment",
                additionalInvestmentHint: "Regular additional investments can significantly boost your final amount through dollar-cost averaging.",
                targetMonthlyIncome: "Target Monthly Income (X)",
                targetMonthlyIncomeHint: "The monthly income you want to achieve from your investment. This helps plan for financial goals.",
                calculatedResults: "Calculated Results",
                finalAmount: "Final Amount",
                finalAmountHint: "Total amount at the end of investment period including all profits",
                totalProfit: "Total Profit",
                totalProfitHint: "Absolute profit and percentage gain over the entire period",
                effectiveRate: "Effective Rate",
                effectiveRateHint: "Actual annualized return considering compounding effect",
                theoreticalMonthlyIncome: "Theoretical Monthly Income",
                theoreticalMonthlyIncomeHint: "Monthly income if withdrawing interest from final amount",
                averageMonthlyProfit: "Avg Monthly Profit",
                averageMonthlyProfitHint: "Average monthly capital growth during investment period",
                averageAnnualProfit: "Avg Annual Profit",
                averageAnnualProfitHint: "Average annual capital growth during investment period",
                keyMilestones: "Key Milestones",
                doubleInvestment: "Double Investment",
                tenfoldInvestment: "Tenfold Investment",
                hundredfoldInvestment: "Hundredfold Investment",
                targetMonthlyIncomeMilestone: "Target Monthly Income",
                monthlyIncomePlan: "Monthly Income Plan",
                doubleShort: "2x",
                tenfoldShort: "10x",
                hundredfoldShort: "100x",
                targetShort: "Target",
                chartTitle: "Investment Growth Chart",
                month: "Month",
                cumulativeAmount: "Cumulative Amount",
                monthlyIncome: "Monthly Income",
                monthlyPercentage: "% of Initial",
                noCompounding: "No Compounding",
                daily: "Daily",
                monthly: "Monthly",
                quarterly: "Quarterly",
                semiAnnually: "Semi-Annually",
                annually: "Annually",
                days: "Days",
                months: "Months",
                years: "Years",
                noAdditional: "No Additional",
                double: "Double",
                tenfold: "Tenfold",
                hundredfold: "Hundredfold"
            },
            ru: {
                title: "ÐšÐ°Ð»ÑŒÐºÑƒÐ»ÑÑ‚Ð¾Ñ€ Ð˜Ð½Ð²ÐµcÑ‚Ð¸Ñ†Ð¸Ð¹",
                inputParameters: "Ð’Ñ…Ð¾Ð´Ð½Ñ‹Ðµ ÐŸÐ°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹",
                initialAmount: "ÐÐ°Ñ‡Ð°Ð»ÑŒÐ½Ð°Ñ cÑƒÐ¼Ð¼Ð° Ð˜Ð½Ð²ÐµcÑ‚Ð¸Ñ†Ð¸Ð¹",
                initialAmountHint: "Ð¡Ñ‚Ð°Ñ€Ñ‚Ð¾Ð²Ð°Ñ cÑƒÐ¼Ð¼Ð° Ð²Ð°ÑˆÐµÐ³Ð¾ Ð²Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ. Ð­Ñ‚Ð¾ Ð±Ð°Ð·Ð¾Ð²Ð°Ñ cÑƒÐ¼Ð¼Ð°, ÐºÐ¾Ñ‚Ð¾Ñ€Ð°Ñ Ð±ÑƒÐ´ÐµÑ‚ Ð¿Ñ€Ð¸Ð½Ð¾cÐ¸Ñ‚ÑŒ Ð¿Ñ€Ð¾Ñ†ÐµÐ½Ñ‚Ñ‹ co Ð²Ñ€ÐµÐ¼ÐµÐ½ÐµÐ¼.",
                interestRate: "Ð“Ð¾Ð´Ð¾Ð²Ð°Ñ ÐŸÑ€Ð¾Ñ†ÐµÐ½Ñ‚Ð½Ð°Ñ cÑ‚Ð°Ð²ÐºÐ° (%)",
                interestRateHint: "Ð“Ð¾Ð´Ð¾Ð²Ð¾Ð¹ Ð¿Ñ€Ð¾Ñ†ÐµÐ½Ñ‚, Ð¿Ð¾ ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð¼Ñƒ Ð±ÑƒÐ´ÐµÑ‚ Ñ€Ð°cÑ‚Ð¸ Ð²Ð°ÑˆÐµ Ð²Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ. Ð‘Ð¾Ð»ÐµÐµ Ð²Ñ‹cÐ¾ÐºÐ¸Ðµ cÑ‚Ð°Ð²ÐºÐ¸ Ð¾Ð·Ð½Ð°Ñ‡Ð°ÑŽÑ‚ Ð±Ð¾Ð»ÐµÐµ Ð±Ñ‹cÑ‚Ñ€Ñ‹Ð¹ Ñ€Ð¾cÑ‚.",
                compounding: "ÐŸÐµÑ€Ð¸Ð¾Ð´ ÐšÐ°Ð¿Ð¸Ñ‚Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸",
                compoundingHint: "ÐšÐ°Ðº Ñ‡Ð°cÑ‚Ð¾ Ð¿Ñ€Ð¾Ñ†ÐµÐ½Ñ‚Ñ‹ Ð´Ð¾Ð±Ð°Ð²Ð»ÑÑŽÑ‚cÑ Ðº Ð¾cÐ½Ð¾Ð²Ð½Ð¾Ð¹ cÑƒÐ¼Ð¼Ðµ. Ð‘Ð¾Ð»ÐµÐµ Ñ‡Ð°cÑ‚Ð°Ñ ÐºÐ°Ð¿Ð¸Ñ‚Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¿Ñ€Ð¸Ð²Ð¾Ð´Ð¸Ñ‚ Ðº Ð±Ð¾Ð»ÐµÐµ Ð²Ñ‹cÐ¾ÐºÐ¾Ð¹ Ð´Ð¾Ñ…Ð¾Ð´Ð½Ð¾cÑ‚Ð¸.",
                investmentTerm: "Ð¡Ñ€Ð¾Ðº Ð˜Ð½Ð²ÐµcÑ‚Ð¸Ñ†Ð¸Ð¹",
                investmentTermHint: "ÐŸÑ€Ð¾Ð´Ð¾Ð»Ð¶Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾cÑ‚ÑŒ Ð²Ð°ÑˆÐµÐ³Ð¾ Ð²Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ. Ð‘Ð¾Ð»ÐµÐµ Ð´Ð»Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ cÑ€Ð¾ÐºÐ¸ Ð¾Ð±Ñ‹Ñ‡Ð½Ð¾ Ð¿Ñ€Ð¸Ð²Ð¾Ð´ÑÑ‚ Ðº Ð±Ð¾Ð»ÐµÐµ Ð²Ñ‹cÐ¾ÐºÐ¾Ð¹ Ð´Ð¾Ñ…Ð¾Ð´Ð½Ð¾cÑ‚Ð¸ Ð±Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€Ñ ÐºÐ°Ð¿Ð¸Ñ‚Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸.",
                additionalInvestment: "Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð’Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ",
                additionalInvestmentHint: "Ð ÐµÐ³ÑƒÐ»ÑÑ€Ð½Ñ‹Ðµ Ð´Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ðµ Ð²Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ Ð¼Ð¾Ð³ÑƒÑ‚ Ð·Ð½Ð°Ñ‡Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ ÑƒÐ²ÐµÐ»Ð¸Ñ‡Ð¸Ñ‚ÑŒ Ð²Ð°ÑˆÑƒ ÐºÐ¾Ð½ÐµÑ‡Ð½ÑƒÑŽ cÑƒÐ¼Ð¼Ñƒ Ð±Ð»Ð°Ð³Ð¾Ð´Ð°Ñ€Ñ ÑƒcÑ€ÐµÐ´Ð½ÐµÐ½Ð¸ÑŽ cÑ‚Ð¾Ð¸Ð¼Ð¾cÑ‚Ð¸.",
                targetMonthlyIncome: "Ð¦ÐµÐ»ÐµÐ²Ð¾Ð¹ ÐœÐµcÑÑ‡Ð½Ñ‹Ð¹ Ð”Ð¾Ñ…Ð¾Ð´ (X)",
                targetMonthlyIncomeHint: "ÐœÐµcÑÑ‡Ð½Ñ‹Ð¹ Ð´Ð¾Ñ…Ð¾Ð´, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð²Ñ‹ Ñ…Ð¾Ñ‚Ð¸Ñ‚Ðµ Ð¿Ð¾Ð»ÑƒÑ‡Ð¸Ñ‚ÑŒ Ð¾Ñ‚ Ð¸Ð½Ð²ÐµcÑ‚Ð¸Ñ†Ð¸Ð¹. Ð­Ñ‚Ð¾ Ð¿Ð¾Ð¼Ð¾Ð³Ð°ÐµÑ‚ Ð¿Ð»Ð°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ñ„Ð¸Ð½Ð°Ð½cÐ¾Ð²Ñ‹Ðµ Ñ†ÐµÐ»Ð¸.",
                calculatedResults: "Ð’Ñ‹Ñ‡Ð¸cÐ»ÑÐµÐ¼Ñ‹Ðµ ÐŸÐ°Ñ€Ð°Ð¼ÐµÑ‚Ñ€Ñ‹",
                finalAmount: "ÐšÐ¾Ð½ÐµÑ‡Ð½Ð°Ñ cÑƒÐ¼Ð¼Ð°",
                finalAmountHint: "ÐžÐ±Ñ‰Ð°Ñ cÑƒÐ¼Ð¼Ð° Ð² ÐºÐ¾Ð½Ñ†Ðµ Ð¿ÐµÑ€Ð¸Ð¾Ð´Ð° Ð¸Ð½Ð²ÐµÑÑ‚Ð¸Ñ†Ð¸Ð¹, Ð²ÐºÐ»ÑŽÑ‡Ð°Ñ Ð²cÑŽ Ð¿Ñ€Ð¸Ð±Ñ‹Ð»ÑŒ",
                totalProfit: "ÐŸÐ¾Ð»Ð½Ñ‹Ð¹ Ð”Ð¾Ñ…Ð¾Ð´",
                totalProfitHint: "ÐÐ±cÐ¾Ð»ÑŽÑ‚Ð½Ð°Ñ Ð¿Ñ€Ð¸Ð±Ñ‹Ð»ÑŒ Ð¸ Ð¿Ñ€Ð¾Ñ†ÐµÐ½Ñ‚Ð½Ñ‹Ð¹ Ð´Ð¾Ñ…Ð¾Ð´ Ð·Ð° Ð²ÐµcÑŒ Ð¿ÐµÑ€Ð¸Ð¾Ð´",
                effectiveRate: "Ð­Ñ„Ñ„ÐµÐºÑ‚Ð¸Ð²Ð½Ð°Ñ cÑ‚Ð°Ð²ÐºÐ°",
                effectiveRateHint: "Ð¤Ð°ÐºÑ‚Ð¸Ñ‡ÐµcÐºÐ°Ñ Ð³Ð¾Ð´Ð¾Ð²Ð°Ñ Ð´Ð¾Ñ…Ð¾Ð´Ð½Ð¾cÑ‚ÑŒ c ÑƒÑ‡ÐµÑ‚Ð¾Ð¼ ÑÑ„Ñ„ÐµÐºÑ‚Ð° ÐºÐ°Ð¿Ð¸Ñ‚Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸",
                theoreticalMonthlyIncome: "Ð¢ÐµÐ¾Ñ€ÐµÑ‚Ð¸Ñ‡ÐµcÐºÐ¸Ð¹ ÐœÐµcÑÑ‡Ð½Ñ‹Ð¹ Ð”Ð¾Ñ…Ð¾Ð´",
                theoreticalMonthlyIncomeHint: "ÐœÐµcÑÑ‡Ð½Ñ‹Ð¹ Ð´Ð¾Ñ…Ð¾Ð´ Ð¿Ñ€Ð¸ cÐ½ÑÑ‚Ð¸Ð¸ Ð¿Ñ€Ð¾Ñ†ÐµÐ½Ñ‚Ð¾Ð² c Ñ„Ð¸Ð½Ð°Ð»ÑŒÐ½Ð¾Ð¹ cÑƒÐ¼Ð¼Ñ‹",
                averageMonthlyProfit: "Ð¡Ñ€ÐµÐ´Ð½Ð¸Ð¹ ÐœÐµcÑÑ‡Ð½Ñ‹Ð¹ ÐŸÑ€Ð¸Ñ€Ð¾cÑ‚",
                averageMonthlyProfitHint: "Ð¡Ñ€ÐµÐ´Ð½ÐµÐ¼ÐµcÑÑ‡Ð½Ñ‹Ð¹ Ñ€Ð¾cÑ‚ ÐºÐ°Ð¿Ð¸Ñ‚Ð°Ð»Ð° Ð·Ð° Ð¿ÐµÑ€Ð¸Ð¾Ð´ Ð¸Ð½Ð²ÐµcÑ‚Ð¸Ñ†Ð¸Ð¹",
                averageAnnualProfit: "Ð¡Ñ€ÐµÐ´Ð½Ð¸Ð¹ Ð“Ð¾Ð´Ð¾Ð²Ð¾Ð¹ ÐŸÑ€Ð¸Ñ€Ð¾cÑ‚",
                averageAnnualProfitHint: "Ð¡Ñ€ÐµÐ´Ð½ÐµÐ³Ð¾Ð´Ð¾Ð²Ð¾Ð¹ Ñ€Ð¾cÑ‚ ÐºÐ°Ð¿Ð¸Ñ‚Ð°Ð»Ð° Ð·Ð° Ð¿ÐµÑ€Ð¸Ð¾Ð´ Ð¸Ð½Ð²ÐµcÑ‚Ð¸Ñ†Ð¸Ð¹",
                keyMilestones: "ÐšÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ðµ Ð’ÐµÑ…Ð¸",
                doubleInvestment: "Ð£Ð´Ð²Ð¾ÐµÐ½Ð¸Ðµ Ð’ÐºÐ»Ð°Ð´Ð°",
                tenfoldInvestment: "Ð£Ð´ÐµcÑÑ‚ÐµÑ€ÐµÐ½Ð¸Ðµ Ð’ÐºÐ»Ð°Ð´Ð°",
                hundredfoldInvestment: "Ð£Ð²ÐµÐ»Ð¸Ñ‡ÐµÐ½Ð¸Ðµ Ð² 100 Ñ€Ð°Ð·",
                targetMonthlyIncomeMilestone: "Ð¦ÐµÐ»ÐµÐ²Ð¾Ð¹ ÐœÐµcÑÑ‡Ð½Ñ‹Ð¹ Ð”Ð¾Ñ…Ð¾Ð´",
                monthlyIncomePlan: "ÐŸÐ¾Ð¼ÐµcÑÑ‡Ð½Ñ‹Ð¹ ÐŸÐ»Ð°Ð½ Ð”Ð¾Ñ…Ð¾Ð´Ð°",
                doubleShort: "2x",
                tenfoldShort: "10x",
                hundredfoldShort: "100x",
                targetShort: "Ð¦ÐµÐ»ÑŒ",
                chartTitle: "Ð“Ñ€Ð°Ñ„Ð¸Ðº Ð Ð¾cÑ‚Ð° Ð˜Ð½Ð²ÐµcÑ‚Ð¸Ñ†Ð¸Ð¹",
                month: "ÐœÐµcÑÑ†",
                cumulativeAmount: "ÐÐ°ÐºÐ¾Ð¿Ð»ÐµÐ½Ð½Ð°Ñ cÑƒÐ¼Ð¼Ð°",
                monthlyIncome: "ÐœÐµcÑÑ‡Ð½Ñ‹Ð¹ Ð”Ð¾Ñ…Ð¾Ð´",
                monthlyPercentage: "% Ð¾Ñ‚ ÐÐ°Ñ‡Ð°Ð»ÑŒÐ½Ð¾Ð¹",
                noCompounding: "Ð‘ÐµÐ· ÐšÐ°Ð¿Ð¸Ñ‚Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸",
                daily: "Ð•Ð¶ÐµÐ´Ð½ÐµÐ²Ð½Ð¾",
                monthly: "Ð•Ð¶ÐµÐ¼ÐµcÑÑ‡Ð½Ð¾",
                quarterly: "Ð•Ð¶ÐµÐºÐ²Ð°Ñ€Ñ‚Ð°Ð»ÑŒÐ½Ð¾",
                semiAnnually: "ÐŸÐ¾Ð»ÑƒÐ³Ð¾Ð´Ð¾Ð²Ð¾Ð¹",
                annually: "Ð•Ð¶ÐµÐ³Ð¾Ð´Ð½Ð¾",
                days: "Ð”Ð½Ð¸",
                months: "ÐœÐµcÑÑ†Ñ‹",
                years: "Ð“Ð¾Ð´Ñ‹",
                noAdditional: "Ð‘ÐµÐ· Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ…",
                double: "Ð£Ð´Ð²Ð¾ÐµÐ½Ð¸Ðµ",
                tenfold: "Ð£Ð´ÐµcÑÑ‚ÐµÑ€ÐµÐ½Ð¸Ðµ",
                hundredfold: "Ð£Ð²ÐµÐ»Ð¸Ñ‡ÐµÐ½Ð¸Ðµ Ð² 100 Ñ€Ð°Ð·"
            }
        };

        let currentLanguage = 'en';

        // DOM Elements
        const elements = {
            languageToggle: document.getElementById('languageToggle'),
            initialAmount: document.getElementById('initialAmount'),
            interestRate: document.getElementById('interestRate'),
            compounding: document.getElementById('compounding'),
            investmentTerm: document.getElementById('investmentTerm'),
            termUnit: document.getElementById('termUnit'),
            additionalAmount: document.getElementById('additionalAmount'),
            additionalFrequency: document.getElementById('additionalFrequency'),
            targetMonthlyIncome: document.getElementById('targetMonthlyIncome'),
            finalAmountValue: document.getElementById('finalAmountValue'),
            totalProfitValue: document.getElementById('totalProfitValue'),
            effectiveRateValue: document.getElementById('effectiveRateValue'),
            theoreticalMonthlyIncomeValue: document.getElementById('theoreticalMonthlyIncomeValue'),
            averageMonthlyProfitValue: document.getElementById('averageMonthlyProfitValue'),
            averageAnnualProfitValue: document.getElementById('averageAnnualProfitValue'),
            doubleValue: document.getElementById('doubleValue'),
            tenfoldValue: document.getElementById('tenfoldValue'),
            hundredfoldValue: document.getElementById('hundredfoldValue'),
            targetIncomeValue: document.getElementById('targetIncomeValue'),
            planTableBody: document.getElementById('planTableBody'),
            chartContainer: document.getElementById('chartContainer')
        };

        // Translation elements mapping
        const translationElements = {
            title: document.getElementById('title'),
            inputParameters: document.querySelector('.input-section .section-title'),
            initialAmountLabel: document.getElementById('initialAmountLabel'),
            initialAmountHint: document.getElementById('initialAmountHint'),
            interestRateLabel: document.getElementById('interestRateLabel'),
            interestRateHint: document.getElementById('interestRateHint'),
            compoundingLabel: document.getElementById('compoundingLabel'),
            compoundingHint: document.getElementById('compoundingHint'),
            investmentTermLabel: document.getElementById('investmentTermLabel'),
            investmentTermHint: document.getElementById('investmentTermHint'),
            additionalInvestmentLabel: document.getElementById('additionalInvestmentLabel'),
            additionalInvestmentHint: document.getElementById('additionalInvestmentHint'),
            targetMonthlyIncomeLabel: document.getElementById('targetMonthlyIncomeLabel'),
            targetMonthlyIncomeHint: document.getElementById('targetMonthlyIncomeHint'),
            calculatedResults: document.querySelector('.results-section .section-title'),
            finalAmountLabel: document.querySelector('[id="finalAmountLabel"]'),
            finalAmountHint: document.querySelector('[id="finalAmountHint"]'),
            totalProfitLabel: document.querySelector('[id="totalProfitLabel"]'),
            totalProfitHint: document.querySelector('[id="totalProfitHint"]'),
            effectiveRateLabel: document.querySelector('[id="effectiveRateLabel"]'),
            effectiveRateHint: document.querySelector('[id="effectiveRateHint"]'),
            theoreticalMonthlyIncomeLabel: document.querySelector('[id="theoreticalMonthlyIncomeLabel"]'),
            theoreticalMonthlyIncomeHint: document.querySelector('[id="theoreticalMonthlyIncomeHint"]'),
            averageMonthlyProfitLabel: document.querySelector('[id="averageMonthlyProfitLabel"]'),
            averageMonthlyProfitHint: document.querySelector('[id="averageMonthlyProfitHint"]'),
            averageAnnualProfitLabel: document.querySelector('[id="averageAnnualProfitLabel"]'),
            averageAnnualProfitHint: document.querySelector('[id="averageAnnualProfitHint"]'),
            keyMilestones: document.querySelector('.milestones-section .section-title'),
            doubleLabel: document.getElementById('doubleLabel'),
            tenfoldLabel: document.getElementById('tenfoldLabel'),
            hundredfoldLabel: document.getElementById('hundredfoldLabel'),
            targetIncomeLabel: document.getElementById('targetIncomeLabel'),
            monthlyIncomePlan: document.querySelector('.plan-section .section-title'),
            chartTitle: document.getElementById('chartTitle'),
            monthLabel: document.getElementById('monthLabel'),
            cumulativeAmountLabel: document.getElementById('cumulativeAmountLabel'),
            monthlyIncomeLabel: document.getElementById('monthlyIncomeLabel'),
            monthlyPercentageLabel: document.getElementById('monthlyPercentageLabel')
        };

        // Initialize compounding options
        function initializeCompoundingOptions(selectedValues = {}) {
            const compoundingOptions = {
                en: [
                    { value: "0", text: "No Compounding" },
                    { value: "1", text: "Daily" },
                    { value: "30", text: "Monthly" },
                    { value: "90", text: "Quarterly" },
                    { value: "180", text: "Semi-Annually" },
                    { value: "365", text: "Annually" }
                ],
                ru: [
                    { value: "0", text: "Ð‘ÐµÐ· ÐšÐ°Ð¿Ð¸Ñ‚Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸" },
                    { value: "1", text: "Ð•Ð¶ÐµÐ´Ð½ÐµÐ²Ð½Ð¾" },
                    { value: "30", text: "Ð•Ð¶ÐµÐ¼ÐµcÑÑ‡Ð½Ð¾" },
                    { value: "90", text: "Ð•Ð¶ÐµÐºÐ²Ð°Ñ€Ñ‚Ð°Ð»ÑŒÐ½Ð¾" },
                    { value: "180", text: "ÐŸÐ¾Ð»ÑƒÐ³Ð¾Ð´Ð¾Ð²Ð¾Ð¹" },
                    { value: "365", text: "Ð•Ð¶ÐµÐ³Ð¾Ð´Ð½Ð¾" }
                ]
            };

            const termUnitOptions = {
                en: [
                    { value: "1", text: "Days" },
                    { value: "30", text: "Months" },
                    { value: "365", text: "Years" }
                ],
                ru: [
                    { value: "1", text: "Ð”Ð½Ð¸" },
                    { value: "30", text: "ÐœÐµcÑÑ†Ñ‹" },
                    { value: "365", text: "Ð“Ð¾Ð´Ñ‹" }
                ]
            };

            const additionalFrequencyOptions = {
                en: [
                    { value: "0", text: "No Additional" },
                    { value: "1", text: "Daily" },
                    { value: "30", text: "Monthly" },
                    { value: "90", text: "Quarterly" },
                    { value: "365", text: "Annually" }
                ],
                ru: [
                    { value: "0", text: "Ð‘ÐµÐ· Ð”Ð¾Ð¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ…" },
                    { value: "1", text: "Ð•Ð¶ÐµÐ´Ð½ÐµÐ²Ð½Ð¾" },
                    { value: "30", text: "Ð•Ð¶ÐµÐ¼ÐµcÑÑ‡Ð½Ð¾" },
                    { value: "90", text: "Ð•Ð¶ÐµÐºÐ²Ð°Ñ€Ñ‚Ð°Ð»ÑŒÐ½Ð¾" },
                    { value: "365", text: "Ð•Ð¶ÐµÐ³Ð¾Ð´Ð½Ð¾" }
                ]
            };

            // Clear and populate compounding options
            elements.compounding.innerHTML = '';
            compoundingOptions[currentLanguage].forEach(option => {
                const opt = document.createElement('option');
                opt.value = option.value;
                opt.textContent = option.text;
                elements.compounding.appendChild(opt);
            });
            elements.compounding.value = selectedValues.compounding || '365';

            // Clear and populate term unit options
            elements.termUnit.innerHTML = '';
            termUnitOptions[currentLanguage].forEach(option => {
                const opt = document.createElement('option');
                opt.value = option.value;
                opt.textContent = option.text;
                elements.termUnit.appendChild(opt);
            });
            elements.termUnit.value = selectedValues.termUnit || '365';

            // Clear and populate additional frequency options
            elements.additionalFrequency.innerHTML = '';
            additionalFrequencyOptions[currentLanguage].forEach(option => {
                const opt = document.createElement('option');
                opt.value = option.value;
                opt.textContent = option.text;
                elements.additionalFrequency.appendChild(opt);
            });
            elements.additionalFrequency.value = selectedValues.additionalFrequency || '30';
        }

        // Update calculations
        function updateCalculations() {
            const principal = parseFloat(elements.initialAmount.value) || 0;
            const rate = parseFloat(elements.interestRate.value) || 0;
            const compoundingDays = parseInt(elements.compounding.value) || 0;
            const termValue = parseFloat(elements.investmentTerm.value) || 0;
            const termUnit = parseInt(elements.termUnit.value) || 365;
            const termDays = termValue * termUnit;
            const additionalAmount = parseFloat(elements.additionalAmount.value) || 0;
            const additionalFrequency = parseInt(elements.additionalFrequency.value) || 0;
            const targetIncome = parseFloat(elements.targetMonthlyIncome.value) || 0;

            // Calculate final amount
            const finalAmount = calculateCompoundInterest(principal, rate, compoundingDays, termDays, additionalAmount, additionalFrequency);
            const totalProfit = finalAmount - principal;
            const totalProfitPercentage = principal > 0 ? (totalProfit / principal) * 100 : 0;

            // Calculate effective rate
            const effectiveRate = (compoundingDays > 0 && principal > 0) ? calculateEffectiveRate(principal, finalAmount, termDays) : rate;

            // Calculate theoretical monthly income (from final amount)
            const theoreticalMonthlyIncome = termDays > 0 ? (finalAmount * (rate / 100) / 12) : 0;

            // Calculate average profits
            const averageProfits = calculateAverageProfits(principal, finalAmount, termDays);

            // Update results
            elements.finalAmountValue.textContent = formatNumber(finalAmount);
            elements.totalProfitValue.textContent = formatNumber(totalProfit) + ` (${totalProfitPercentage.toFixed(1)}%)`;
            elements.effectiveRateValue.textContent = effectiveRate.toFixed(2) + '%';
            elements.theoreticalMonthlyIncomeValue.textContent = formatNumber(theoreticalMonthlyIncome);
            elements.averageMonthlyProfitValue.textContent = formatNumber(averageProfits.monthly) + ` (${averageProfits.monthlyPercent.toFixed(2)}%)`;
            elements.averageAnnualProfitValue.textContent = formatNumber(averageProfits.annual) + ` (${averageProfits.annualPercent.toFixed(2)}%)`;

            // Calculate milestones
            const milestones = calculateMilestones(principal, rate, compoundingDays, additionalAmount, additionalFrequency, targetIncome);
            elements.doubleValue.textContent = formatTimePeriod(milestones.double, currentLanguage);
            elements.tenfoldValue.textContent = formatTimePeriod(milestones.tenfold, currentLanguage);
            elements.hundredfoldValue.textContent = formatTimePeriod(milestones.hundredfold, currentLanguage);
            elements.targetIncomeValue.textContent = formatTimePeriod(milestones.targetIncome, currentLanguage);

            // Calculate monthly plan
            const monthlyPlan = calculateMonthlyPlan(principal, rate, compoundingDays, termDays, additionalAmount, additionalFrequency);
            const chartData = generateChartData(principal, rate, compoundingDays, termDays, additionalAmount, additionalFrequency);

            updateMonthlyPlanTable(monthlyPlan, principal);
            renderSvgChart(chartData, termDays, milestones);
        }
        
        // Render SVG chart for investment growth
        function renderSvgChart(chartData, termDays, milestones) {
            const container = elements.chartContainer;
            container.innerHTML = ''; // Clear previous chart

            if (!chartData || chartData.length < 2) {
                container.textContent = currentLanguage === 'ru' ? 'ÐÐµÐ´Ð¾ÑÑ‚Ð°Ñ‚Ð¾Ñ‡Ð½Ð¾ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ð´Ð»Ñ Ð³Ñ€Ð°Ñ„Ð¸ÐºÐ°' : 'Not enough data for a chart';
                return;
            }

            // Create tooltip element and append it to the container
            const tooltip = document.createElement('div');
            tooltip.className = 'chart-tooltip';
            container.appendChild(tooltip);

            const svgNS = "http://www.w3.org/2000/svg";
            const svg = document.createElementNS(svgNS, "svg");

            const padding = { top: 20, right: 20, bottom: 50, left: 70 };
            const width = container.clientWidth;
            const height = container.clientHeight;

            // Fallback for non-visible containers
            if (width === 0 || height === 0) return;

            svg.setAttribute('viewBox', `0 0 ${width} ${height}`);

            const chartWidth = width - padding.left - padding.right;
            const chartHeight = height - padding.top - padding.bottom;

            const amounts = chartData.map(d => d.amount);
            const minAmount = Math.min(...amounts);
            let maxAmount = Math.max(...amounts);

            // Handle edge case where min and max are the same to avoid division by zero
            if (maxAmount <= minAmount) {
                maxAmount = minAmount + 1;
            }
            const range = maxAmount - minAmount;

            // Create scales
            const xScale = (day) => padding.left + (day / termDays) * chartWidth;
            const yScale = (amount) => {
                if (range === 0) return padding.top + chartHeight / 2; // Center the line if no change
                return padding.top + chartHeight - ((amount - minAmount) / range) * chartHeight;
            };

            // --- Gradient Definition ---
            const defs = document.createElementNS(svgNS, 'defs');
            const gradient = document.createElementNS(svgNS, 'linearGradient');
            gradient.id = 'chartGradient';
            gradient.setAttribute('x1', '0%');
            gradient.setAttribute('y1', '0%');
            gradient.setAttribute('x2', '0%');
            gradient.setAttribute('y2', '100%');
            
            const stop1 = document.createElementNS(svgNS, 'stop');
            stop1.setAttribute('offset', '0%');
            stop1.setAttribute('stop-color', 'var(--primary)');
            stop1.setAttribute('stop-opacity', '0.2');
            
            const stop2 = document.createElementNS(svgNS, 'stop');
            stop2.setAttribute('offset', '100%');
            stop2.setAttribute('stop-color', 'var(--primary)');
            stop2.setAttribute('stop-opacity', '0');

            gradient.appendChild(stop1);
            gradient.appendChild(stop2);
            defs.appendChild(gradient);
            svg.appendChild(defs);

            // --- Grid Lines & Y-Axis Labels ---
            const gridGroup = document.createElementNS(svgNS, 'g');
            const yAxisTicks = 10;
            for (let i = 0; i <= yAxisTicks; i++) {
                const y = padding.top + (i / yAxisTicks) * chartHeight;
                const value = minAmount + range * (1 - i / yAxisTicks);

                const line = document.createElementNS(svgNS, 'line');
                line.setAttribute('x1', padding.left);
                line.setAttribute('y1', y);
                line.setAttribute('x2', width - padding.right);
                line.setAttribute('y2', y);
                line.setAttribute('class', 'grid-line');
                gridGroup.appendChild(line);

                const text = document.createElementNS(svgNS, 'text');
                text.setAttribute('x', padding.left - 10);
                text.setAttribute('y', y);
                text.setAttribute('dy', '0.3em');
                text.setAttribute('text-anchor', 'end');
                text.setAttribute('class', 'axis-label');
                text.textContent = formatNumber(value);
                gridGroup.appendChild(text);
            }
            svg.appendChild(gridGroup);

            // --- X-Axis Labels ---
            const xAxisGroup = document.createElementNS(svgNS, 'g');
            const numTicksX = 10;

            let unitDivisor = 1;
            let unitLabel = currentLanguage === 'ru' ? 'Ð”Ð½Ð¸' : 'Days';
            if (termDays > 365 * 2) {
                unitDivisor = 365;
                unitLabel = currentLanguage === 'ru' ? 'Ð“Ð¾Ð´Ñ‹' : 'Years';
            } else if (termDays > 60) {
                unitDivisor = 30;
                unitLabel = currentLanguage === 'ru' ? 'ÐœÐµÑÑÑ†Ñ‹' : 'Months';
            }

            const maxUnits = termDays / unitDivisor;

            // Calculate a "nice" integer step between ticks to avoid duplicates and decimals
            let step = Math.ceil(maxUnits / numTicksX);
            if (step > 1) {
                const powerOf10 = Math.pow(10, Math.floor(Math.log10(step)));
                const normalizedStep = step / powerOf10;
                if (normalizedStep > 5) step = 10 * powerOf10;
                else if (normalizedStep > 2) step = 5 * powerOf10;
                else if (normalizedStep > 1) step = 2 * powerOf10;
                else step = 1 * powerOf10;
            }
            step = Math.max(1, step); // Ensure step is at least 1

            for (let i = 0; ; i++) {
                 const unitValue = i * step;
                 if (unitValue > maxUnits) break;

                 const dayValue = unitValue * unitDivisor;
                 const x = xScale(dayValue);

                 // Add vertical grid line
                 const vLine = document.createElementNS(svgNS, 'line');
                 vLine.setAttribute('x1', x);
                 vLine.setAttribute('y1', padding.top);
                 vLine.setAttribute('x2', x);
                 vLine.setAttribute('y2', height - padding.bottom);
                 vLine.setAttribute('class', 'grid-line');
                 gridGroup.appendChild(vLine);

                 const text = document.createElementNS(svgNS, 'text');
                 text.setAttribute('x', x);
                 text.setAttribute('y', height - padding.bottom + 20);
                 text.setAttribute('text-anchor', 'middle');
                 text.setAttribute('class', 'axis-label');
                 text.textContent = unitValue.toString();
                 xAxisGroup.appendChild(text);
            }

            const axisTitle = document.createElementNS(svgNS, 'text');
            axisTitle.setAttribute('x', padding.left + chartWidth / 2);
            axisTitle.setAttribute('y', height - padding.bottom + 40);
            axisTitle.setAttribute('text-anchor', 'middle');
            axisTitle.setAttribute('class', 'axis-label');
            axisTitle.style.fontWeight = '600';
            axisTitle.textContent = unitLabel;
            xAxisGroup.appendChild(axisTitle);

            svg.appendChild(xAxisGroup);

            // --- Chart Path ---
            const pathData = chartData.map((d, i) => {
                const x = xScale(d.day);
                const y = yScale(d.amount);
                return `${i === 0 ? 'M' : 'L'} ${x.toFixed(2)},${y.toFixed(2)}`;
            }).join(' ');

            // --- Fill Path ---
            const fillPathData = `${pathData} L ${xScale(termDays).toFixed(2)},${(height - padding.bottom).toFixed(2)} L ${xScale(0).toFixed(2)},${(height - padding.bottom).toFixed(2)} Z`;
            const fillPath = document.createElementNS(svgNS, 'path');
            fillPath.setAttribute('d', fillPathData);
            fillPath.setAttribute('class', 'chart-fill');
            svg.appendChild(fillPath);

            // --- Line Path ---
            const linePath = document.createElementNS(svgNS, 'path');
            linePath.setAttribute('d', pathData);
            linePath.setAttribute('class', 'chart-line');
            svg.appendChild(linePath);

            // --- Milestone Markers ---
            const milestoneMarkersGroup = document.createElementNS(svgNS, 'g');
            const t = translations[currentLanguage];
            const milestoneData = [
                { key: 'double', days: milestones.double, color: 'var(--milestone-double)', label: t.doubleShort },
                { key: 'tenfold', days: milestones.tenfold, color: 'var(--milestone-tenfold)', label: t.tenfoldShort },
                { key: 'hundredfold', days: milestones.hundredfold, color: 'var(--milestone-hundredfold)', label: t.hundredfoldShort },
                { key: 'targetIncome', days: milestones.targetIncome, color: 'var(--milestone-target)', label: t.targetShort }
            ];

            milestoneData.forEach(marker => {
                if (marker.days > 0 && marker.days <= termDays) {
                    const x = xScale(marker.days);

                    // Marker line
                    const line = document.createElementNS(svgNS, 'line');
                    line.setAttribute('x1', x);
                    line.setAttribute('y1', padding.top);
                    line.setAttribute('x2', x);
                    line.setAttribute('y2', height - padding.bottom);
                    line.setAttribute('class', 'milestone-line');
                    line.style.stroke = marker.color;
                    milestoneMarkersGroup.appendChild(line);

                    // Marker label
                    const text = document.createElementNS(svgNS, 'text');
                    text.setAttribute('x', x);
                    text.setAttribute('y', padding.top - 5);
                    text.setAttribute('class', 'milestone-label');
                    text.style.fill = marker.color;
                    text.textContent = marker.label;
                    milestoneMarkersGroup.appendChild(text);
                }
            });
            svg.appendChild(milestoneMarkersGroup);

            // --- Indicators and Tooltip Logic ---
            const indicatorLineY = document.createElementNS(svgNS, 'line');
            indicatorLineY.setAttribute('class', 'chart-indicator-line');
            indicatorLineY.style.display = 'none';
            svg.appendChild(indicatorLineY);

            const indicatorLineX = document.createElementNS(svgNS, 'line');
            indicatorLineX.setAttribute('class', 'chart-indicator-line');
            indicatorLineX.style.display = 'none';
            svg.appendChild(indicatorLineX);

            const indicatorPoint = document.createElementNS(svgNS, 'circle');
            indicatorPoint.setAttribute('class', 'chart-indicator-point');
            indicatorPoint.style.display = 'none';
            svg.appendChild(indicatorPoint);

            svg.addEventListener('mouseover', () => {
                tooltip.style.display = 'block';
                indicatorLineY.style.display = 'block';
                indicatorLineX.style.display = 'block';
                indicatorPoint.style.display = 'block';
            });

            svg.addEventListener('mouseout', () => {
                tooltip.style.display = 'none';
                indicatorLineY.style.display = 'none';
                indicatorLineX.style.display = 'none';
                indicatorPoint.style.display = 'none';
            });

            svg.addEventListener('mousemove', (event) => {
                const rect = svg.getBoundingClientRect();
                const mouseX = event.clientX - rect.left;

                // Convert mouse X to day value, clamped to the chart bounds
                const dayAtMouse = Math.max(0, Math.min(termDays, (mouseX - padding.left) / chartWidth * termDays));

                // Find the closest data point using reduce (efficient enough for ~200 points)
                const closestPoint = chartData.reduce((prev, curr) => {
                    return (Math.abs(curr.day - dayAtMouse) < Math.abs(prev.day - dayAtMouse) ? curr : prev);
                });

                const pointX = xScale(closestPoint.day);
                const pointY = yScale(closestPoint.amount);

                // Update indicator positions
                indicatorLineY.setAttribute('x1', pointX);
                indicatorLineY.setAttribute('y1', padding.top);
                indicatorLineY.setAttribute('x2', pointX);
                indicatorLineY.setAttribute('y2', height - padding.bottom);

                indicatorLineX.setAttribute('x1', padding.left);
                indicatorLineX.setAttribute('y1', pointY);
                indicatorLineX.setAttribute('x2', width - padding.right);
                indicatorLineX.setAttribute('y2', pointY);
                
                indicatorPoint.setAttribute('cx', pointX);
                indicatorPoint.setAttribute('cy', pointY);
                indicatorPoint.setAttribute('r', 5);

                // Update tooltip content and position
                const dayLabel = currentLanguage === 'ru' ? 'Ð”ÐµÐ½ÑŒ' : 'Day';
                const amountLabel = currentLanguage === 'ru' ? 'Ð¡ÑƒÐ¼Ð¼Ð°' : 'Amount';
                tooltip.innerHTML = `<strong>${dayLabel}:</strong> ${Math.round(closestPoint.day)}<br><strong>${amountLabel}:</strong> ${formatNumber(closestPoint.amount)}`;
                
                tooltip.style.left = `${pointX}px`;
                tooltip.style.top = `${pointY}px`;
            });

            container.appendChild(svg);
        }

        // Update monthly plan table
        function updateMonthlyPlanTable(monthlyData, principal) {
            elements.planTableBody.innerHTML = '';
            
            monthlyData.forEach(data => {
                const row = document.createElement('tr');
                row.className = 'plan-table__row';
                row.innerHTML = `
                    <td class="plan-table__cell">${data.month}</td>
                    <td class="plan-table__cell plan-table__cell--cumulative">${formatNumber(data.cumulativeAmount)}</td>
                    <td class="plan-table__cell ${data.monthlyIncome >= 0 ? 'plan-table__cell--positive' : 'plan-table__cell--negative'}">${formatNumber(data.monthlyIncome)}</td>
                    <td class="plan-table__cell">${data.percentageOfInitial.toFixed(2)}%</td>
                `;
                elements.planTableBody.appendChild(row);
            });
        }

        // Translate UI
        function translateUI() {
            const t = translations[currentLanguage];
            
            // Store current select values before they are reset
            const selectedValues = {
                compounding: elements.compounding.value,
                termUnit: elements.termUnit.value,
                additionalFrequency: elements.additionalFrequency.value
            };

            // Update text content
            translationElements.title.textContent = t.title; // This is already a BEM element: header__title
            document.querySelector('.input-section .section__title').textContent = t.inputParameters;
            document.getElementById('initialAmountLabel').textContent = t.initialAmount;
            document.getElementById('initialAmountHint').textContent = t.initialAmountHint;
            document.getElementById('interestRateLabel').textContent = t.interestRate;
            document.getElementById('interestRateHint').textContent = t.interestRateHint;
            document.getElementById('compoundingLabel').textContent = t.compounding;
            document.getElementById('compoundingHint').textContent = t.compoundingHint;
            document.getElementById('investmentTermLabel').textContent = t.investmentTerm;
            document.getElementById('investmentTermHint').textContent = t.investmentTermHint;
            document.getElementById('additionalInvestmentLabel').textContent = t.additionalInvestment;
            document.getElementById('additionalInvestmentHint').textContent = t.additionalInvestmentHint;
            document.getElementById('targetMonthlyIncomeLabel').textContent = t.targetMonthlyIncome;
            document.getElementById('targetMonthlyIncomeHint').textContent = t.targetMonthlyIncomeHint;
            document.querySelector('.results-section .section__title').textContent = t.calculatedResults;
            document.querySelector('[id="finalAmountLabel"]').textContent = t.finalAmount;
            document.querySelector('[id="finalAmountHint"]').textContent = t.finalAmountHint;
            document.querySelector('[id="totalProfitLabel"]').textContent = t.totalProfit;
            document.querySelector('[id="totalProfitHint"]').textContent = t.totalProfitHint;
            document.querySelector('[id="effectiveRateLabel"]').textContent = t.effectiveRate;
            document.querySelector('[id="effectiveRateHint"]').textContent = t.effectiveRateHint;
            document.querySelector('[id="theoreticalMonthlyIncomeLabel"]').textContent = t.theoreticalMonthlyIncome;
            document.querySelector('[id="theoreticalMonthlyIncomeHint"]').textContent = t.theoreticalMonthlyIncomeHint;
            document.querySelector('[id="averageMonthlyProfitLabel"]').textContent = t.averageMonthlyProfit;
            document.querySelector('[id="averageMonthlyProfitHint"]').textContent = t.averageMonthlyProfitHint;
            document.querySelector('[id="averageAnnualProfitLabel"]').textContent = t.averageAnnualProfit;
            document.querySelector('[id="averageAnnualProfitHint"]').textContent = t.averageAnnualProfitHint;
            document.querySelector('.milestones-section .section__title').textContent = t.keyMilestones;
            document.getElementById('doubleLabel').textContent = t.doubleInvestment;
            document.getElementById('tenfoldLabel').textContent = t.tenfoldInvestment;
            document.getElementById('hundredfoldLabel').textContent = t.hundredfoldInvestment;
            document.getElementById('targetIncomeLabel').textContent = t.targetMonthlyIncomeMilestone;
            document.querySelector('.plan-section .section__title').textContent = t.monthlyIncomePlan;
            document.getElementById('monthLabel').textContent = t.month;
            document.getElementById('cumulativeAmountLabel').textContent = t.cumulativeAmount;
            document.getElementById('monthlyIncomeLabel').textContent = t.monthlyIncome;
            document.getElementById('monthlyPercentageLabel').textContent = t.monthlyPercentage;

            // Update button text
            elements.languageToggle.textContent = currentLanguage === 'en' ? 'RU' : 'EN';

            // Reinitialize options
            initializeCompoundingOptions(selectedValues);
            
            // Recalculate values to update language-dependent text (e.g., milestones)
            updateCalculations();
        }

        // Event listeners
        elements.languageToggle.addEventListener('click', () => {
            currentLanguage = (currentLanguage === 'en') ? 'ru' : 'en';
            translateUI();
        });

        // Add event listeners to all input fields
        Object.values(elements).forEach(element => {
            if (element?.addEventListener) {
                element.addEventListener('input', updateCalculations);
            }
        });

        // Initialize after DOM is fully loaded to ensure correct element dimensions
        document.addEventListener('DOMContentLoaded', () => {
            initializeCompoundingOptions();
            updateCalculations();
        });
    </script>
</body>
</html>